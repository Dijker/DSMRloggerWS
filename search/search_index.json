{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Documentatie DSMRloggerWS Voor de project beschrijving ga naar www.aandewiel.nl . Inhoudsopgave Introductie Voorbereiding ArduinoIDE ESP8266 core Data Upload Tool Firmware Benodigd Bibliotheken Installeren Bibliotheken DSMR Firmware van Github Firmware Flashen DSMR-logger V4 board Data Flashen naar DSMR-logger V4 board Firmware Flashen ESP-01 Data Flashen naar ESP-01 Hardware DSMR-logger Versie 4 Programmer voor de DSMR-logger DSMR-logger Versie 3 Programmer voor de ESP-01 Verschillen ESP8266 modules Over The Air (bug?) [ScreenShot DSMR-Actueel]","title":"Documentatie DSMRloggerWS"},{"location":"#documentatie-dsmrloggerws","text":"Voor de project beschrijving ga naar www.aandewiel.nl .","title":"Documentatie DSMRloggerWS"},{"location":"#inhoudsopgave","text":"Introductie Voorbereiding ArduinoIDE ESP8266 core Data Upload Tool Firmware Benodigd Bibliotheken Installeren Bibliotheken DSMR Firmware van Github Firmware Flashen DSMR-logger V4 board Data Flashen naar DSMR-logger V4 board Firmware Flashen ESP-01 Data Flashen naar ESP-01 Hardware DSMR-logger Versie 4 Programmer voor de DSMR-logger DSMR-logger Versie 3 Programmer voor de ESP-01 Verschillen ESP8266 modules Over The Air (bug?) [ScreenShot DSMR-Actueel]","title":"Inhoudsopgave"},{"location":"MITlicense/","text":"MIT License Copyright 2018 - 2019 Willem Aandewiel Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"License"},{"location":"MITlicense/#mit-license","text":"Copyright 2018 - 2019 Willem Aandewiel Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"MIT License"},{"location":"benodigdeBibliotheken/","text":"Benodigde Bibliotheken Voor de DSMRloggerWS firmware zijn de volgende bibliotheken nodig: dsmr Deze library is ontwikkeld door Matthijs Kooijman en vormt het hart van de DSMR-logger. Je kunt de bibliotheek hier (https://github.com/matthijskooijman/arduino-dsmr) downloaden. De firmware is getest met Version 0.1 - Commit f79c906 on 18 Sep 2018 . TimeLib Deze is door Paul Stoffregen ontwikkeld. Je kunt hem hier (https://github.com/PaulStoffregen/Time) downloaden. WiFiManager Je kunt de, door Tzapu ontwikkelde, bibliotheek hier (https://github.com/tzapu/WiFiManager) downloaden. De DSMR-logger firmware is getest met version 0.14.0 van deze bibliotheek. TelnetStream Deze bibliotheek is door Jan Drassy ontwikkeld. Je kunt deze bibliotheek hier (https://github.com/jandrassy/TelnetStream) downloaden. De firmware is getest met version 0.0.1 . Let op: De installatie van deze bibliotheek gaat net als de andere bibliotheken. Een update kan echter pas ge\u00efnstalleerd worden als \u00e9\u00e9rst de map TelnetStream-master uit de map Libraries wordt verwijderd! WebSocketsServer Deze bibliotheek is ontwikkeld door Markus Sattler en je kunt hem hier (https://github.com/Links2004/arduinoWebSockets) downloaden. De DSMR-logger firmware is getest met Version 20.05.2015 - commit 72731be on 16 Jan 2019 . SSD1306Ascii William Greiman heeft deze bibliotheek ontwikkeld met in het achterhoofd minimaal gebruik van resources (dus: een bibliotheek die weinig geheugen gebruikt). Je kunt de bibliotheek hier (https://github.com/greiman/SSD1306Ascii) downloaden. De DSMR-logger Firmware is getest met Version 1.2.x - Commit 97a05cd on 24 Mar 2019 . Overige libraries Onderstaande libraries zijn onderdeel van de ESP8266 Core en moeten dus niet handmatig ge\u00efnstalleerd worden ! * ESP8266WiFi * ESP8266WebServer * WiFiUdp * ESP8266mDNS * FS * ArduinoOTA [ScreenShot DSMR-Chart Dag]","title":"Benodigd Bibliotheken"},{"location":"benodigdeBibliotheken/#benodigde-bibliotheken","text":"Voor de DSMRloggerWS firmware zijn de volgende bibliotheken nodig:","title":"Benodigde Bibliotheken"},{"location":"benodigdeBibliotheken/#dsmr","text":"Deze library is ontwikkeld door Matthijs Kooijman en vormt het hart van de DSMR-logger. Je kunt de bibliotheek hier (https://github.com/matthijskooijman/arduino-dsmr) downloaden. De firmware is getest met Version 0.1 - Commit f79c906 on 18 Sep 2018 .","title":"dsmr"},{"location":"benodigdeBibliotheken/#timelib","text":"Deze is door Paul Stoffregen ontwikkeld. Je kunt hem hier (https://github.com/PaulStoffregen/Time) downloaden.","title":"TimeLib"},{"location":"benodigdeBibliotheken/#wifimanager","text":"Je kunt de, door Tzapu ontwikkelde, bibliotheek hier (https://github.com/tzapu/WiFiManager) downloaden. De DSMR-logger firmware is getest met version 0.14.0 van deze bibliotheek.","title":"WiFiManager"},{"location":"benodigdeBibliotheken/#telnetstream","text":"Deze bibliotheek is door Jan Drassy ontwikkeld. Je kunt deze bibliotheek hier (https://github.com/jandrassy/TelnetStream) downloaden. De firmware is getest met version 0.0.1 . Let op: De installatie van deze bibliotheek gaat net als de andere bibliotheken. Een update kan echter pas ge\u00efnstalleerd worden als \u00e9\u00e9rst de map TelnetStream-master uit de map Libraries wordt verwijderd!","title":"TelnetStream"},{"location":"benodigdeBibliotheken/#websocketsserver","text":"Deze bibliotheek is ontwikkeld door Markus Sattler en je kunt hem hier (https://github.com/Links2004/arduinoWebSockets) downloaden. De DSMR-logger firmware is getest met Version 20.05.2015 - commit 72731be on 16 Jan 2019 .","title":"WebSocketsServer"},{"location":"benodigdeBibliotheken/#ssd1306ascii","text":"William Greiman heeft deze bibliotheek ontwikkeld met in het achterhoofd minimaal gebruik van resources (dus: een bibliotheek die weinig geheugen gebruikt). Je kunt de bibliotheek hier (https://github.com/greiman/SSD1306Ascii) downloaden. De DSMR-logger Firmware is getest met Version 1.2.x - Commit 97a05cd on 24 Mar 2019 .","title":"SSD1306Ascii"},{"location":"benodigdeBibliotheken/#overige-libraries","text":"Onderstaande libraries zijn onderdeel van de ESP8266 Core en moeten dus niet handmatig ge\u00efnstalleerd worden ! * ESP8266WiFi * ESP8266WebServer * WiFiUdp * ESP8266mDNS * FS * ArduinoOTA [ScreenShot DSMR-Chart Dag]","title":"Overige libraries"},{"location":"clonenFirmware/","text":"Clonen Firmware De DSMRloggerWS firmware staat hier (https://github.com/mrWheel/DSMRloggerWS). Er zijn twee manieren om de firmware te clonen. download de repository als een .zip file gebruik git Als je niet handig bent met git raad ik je aan de repository als een .zip file te downloaden. Download .zip file Klik op de groene knop [ Clone or Download ] en selecteer [ Download ZIP] Er volgt een scherm als dit: Bewaar het .zip bestand op een plek op je computer waar je hem terug kunt vinden. Unzip het DSMRloggerWS-master.zip bestand in de ArduinoIDE Sketchbook Location . Rename de map DSMRloggerWS-master naar DSMRloggerWS (dus zonder -master ) Ga verder naar DSMRloggerWS Sketch openen git clone Om de repository met git te kunnen clonen moet je er \u00e9\u00e9rst voor zorgen dat je git op je systeem hebt staan. Hoe je dat moet doen valt buiten de scope van deze documentatie maar met Google kun je alles vinden over hoe je dit, voor jouw systeem, moet doen. Voor nu ga ik ervan uit dat je git op je systeem hebt staan en dat je weet hoe je ermee moet werken. Ga naar de Arduino Sketchbook location (de map waar al je Sketches in staan, kijk hier ) en toets het volgende commando in: git clone https://github.com/mrWheel/DSMRloggerWS.git That's it! In Sketchbook location staat hierna een nieuwe map met de naam DSMRloggerWS . DSMRloggerWS Sketch openen Start de ArduinoIDE opnieuw op en klik op het open icoon . Selecteer in het drop-down menu .. .. de sketch DSMRloggerWS Er verschijnt een nieuw editor window met de firmware van de DSMRlogger! [ScreenShot DSMR-Settings]","title":"DSMR-Firmware"},{"location":"clonenFirmware/#clonen-firmware","text":"De DSMRloggerWS firmware staat hier (https://github.com/mrWheel/DSMRloggerWS). Er zijn twee manieren om de firmware te clonen. download de repository als een .zip file gebruik git Als je niet handig bent met git raad ik je aan de repository als een .zip file te downloaden.","title":"Clonen Firmware"},{"location":"clonenFirmware/#download-zip-file","text":"Klik op de groene knop [ Clone or Download ] en selecteer [ Download ZIP] Er volgt een scherm als dit: Bewaar het .zip bestand op een plek op je computer waar je hem terug kunt vinden. Unzip het DSMRloggerWS-master.zip bestand in de ArduinoIDE Sketchbook Location . Rename de map DSMRloggerWS-master naar DSMRloggerWS (dus zonder -master ) Ga verder naar DSMRloggerWS Sketch openen","title":"Download .zip file"},{"location":"clonenFirmware/#git-clone","text":"Om de repository met git te kunnen clonen moet je er \u00e9\u00e9rst voor zorgen dat je git op je systeem hebt staan. Hoe je dat moet doen valt buiten de scope van deze documentatie maar met Google kun je alles vinden over hoe je dit, voor jouw systeem, moet doen. Voor nu ga ik ervan uit dat je git op je systeem hebt staan en dat je weet hoe je ermee moet werken. Ga naar de Arduino Sketchbook location (de map waar al je Sketches in staan, kijk hier ) en toets het volgende commando in: git clone https://github.com/mrWheel/DSMRloggerWS.git That's it! In Sketchbook location staat hierna een nieuwe map met de naam DSMRloggerWS .","title":"git clone"},{"location":"clonenFirmware/#dsmrloggerws-sketch-openen","text":"Start de ArduinoIDE opnieuw op en klik op het open icoon . Selecteer in het drop-down menu .. .. de sketch DSMRloggerWS Er verschijnt een nieuw editor window met de firmware van de DSMRlogger! [ScreenShot DSMR-Settings]","title":"DSMRloggerWS Sketch openen"},{"location":"esp8266FS/","text":"Arduino ESP8266 filesystem uploader Arduino plugin which packs sketch data folder into SPIFFS filesystem image, and uploads the image to ESP8266 flash memory. Tested with the following Arduino IDE versions: 1.6.5-r2, 1.6.6 Installation Make sure you use one of the supported versions of Arduino IDE and have ESP8266 core installed. Download the tool archive from releases page . In your Arduino sketchbook directory, create tools directory if it doesn't exist yet. You can find the location of your sketchbook directory in the Arduino IDE at File Preferences Sketchbook location . Unpack the tool into tools directory (the path will look like sketchbook directory /tools/ESP8266FS/tool/esp8266fs.jar) . Restart Arduino IDE. Usage Open a sketch (or create a new one and save it). Go to sketch directory (choose Sketch Show Sketch Folder). Create a directory named data and any files you want in the file system there. Make sure you have selected a board, port, and closed Serial Monitor. Select Tools ESP8266 Sketch Data Upload menu item. This should start uploading the files into ESP8266 flash file system. When done, IDE status bar will display SPIFFS Image Uploaded message. Might take a few minutes for large file system sizes. Screenshot Credits and license Copyright (c) 2015 Hristo Gochkov (ficeto at ficeto dot com) Licensed under GPL v2 ( text ) Maintained by Ivan Grokhotkov (ivan at esp8266 dot com) Issues and suggestions File issues here on github, or ask your questions on the esp8266.com forum .","title":"Arduino ESP8266 filesystem uploader [![Build Status](https://travis-ci.org/esp8266/arduino-esp8266fs-plugin.svg?branch=master)](https://travis-ci.org/esp8266/arduino-esp8266fs-plugin)"},{"location":"esp8266FS/#arduino-esp8266-filesystem-uploader","text":"Arduino plugin which packs sketch data folder into SPIFFS filesystem image, and uploads the image to ESP8266 flash memory. Tested with the following Arduino IDE versions: 1.6.5-r2, 1.6.6","title":"Arduino ESP8266 filesystem uploader"},{"location":"esp8266FS/#installation","text":"Make sure you use one of the supported versions of Arduino IDE and have ESP8266 core installed. Download the tool archive from releases page . In your Arduino sketchbook directory, create tools directory if it doesn't exist yet. You can find the location of your sketchbook directory in the Arduino IDE at File Preferences Sketchbook location . Unpack the tool into tools directory (the path will look like sketchbook directory /tools/ESP8266FS/tool/esp8266fs.jar) . Restart Arduino IDE.","title":"Installation"},{"location":"esp8266FS/#usage","text":"Open a sketch (or create a new one and save it). Go to sketch directory (choose Sketch Show Sketch Folder). Create a directory named data and any files you want in the file system there. Make sure you have selected a board, port, and closed Serial Monitor. Select Tools ESP8266 Sketch Data Upload menu item. This should start uploading the files into ESP8266 flash file system. When done, IDE status bar will display SPIFFS Image Uploaded message. Might take a few minutes for large file system sizes.","title":"Usage"},{"location":"esp8266FS/#screenshot","text":"","title":"Screenshot"},{"location":"esp8266FS/#credits-and-license","text":"Copyright (c) 2015 Hristo Gochkov (ficeto at ficeto dot com) Licensed under GPL v2 ( text ) Maintained by Ivan Grokhotkov (ivan at esp8266 dot com)","title":"Credits and license"},{"location":"esp8266FS/#issues-and-suggestions","text":"File issues here on github, or ask your questions on the esp8266.com forum .","title":"Issues and suggestions"},{"location":"gh-pages/","text":"Github pages onderhouden Voer, in een command window, de volgende commando's in: cd waar je de boel wilt hebben git clone https://github.com/mrWheel/DSMRloggerHTTP.git cd DSMRloggerHTTP git checkout gh-pages cd mkdocs In de mkdocs map zit een map docs met daarin alle .md bestanden. Pas deze naar hartelust aan. Je kunt vervolgens lokaal een server starten met het commando: mkdocs serve Ga vervolgens met een browser naar http://127.0.0.1:8000 om je werk te bekijken. Als je tevreden bent dan moet je de aangepaste sources naar github pushen: mkdocs build mkdocs gh-deploy git add mkdocs git commit -m reden van deze commit git push -u origin gh-pages Klaar!","title":"Github pages onderhouden"},{"location":"gh-pages/#github-pages-onderhouden","text":"Voer, in een command window, de volgende commando's in: cd waar je de boel wilt hebben git clone https://github.com/mrWheel/DSMRloggerHTTP.git cd DSMRloggerHTTP git checkout gh-pages cd mkdocs In de mkdocs map zit een map docs met daarin alle .md bestanden. Pas deze naar hartelust aan. Je kunt vervolgens lokaal een server starten met het commando: mkdocs serve Ga vervolgens met een browser naar http://127.0.0.1:8000 om je werk te bekijken. Als je tevreden bent dan moet je de aangepaste sources naar github pushen: mkdocs build mkdocs gh-deploy git add mkdocs git commit -m reden van deze commit git push -u origin gh-pages Klaar!","title":"Github pages onderhouden"},{"location":"hardware_DSMR_Programmer/","text":"Programmer voor de DSMR-logger Er zijn verschillende manieren om de DSMR-logger van (nieuwe) firmware te voorzien. Dit gaat het eenvoudigst Over The Air (OTA) maar de eerste keer zal dit altijd bedraad moeten. Je kunt hiervoor een FDTI-adapter gebruiken als je er maar voor zorgt dat Vcc 3v3 is! Je moet de volgende verbindingen maken: Programmer DSMR-logger Opmerking Vcc Vcc LET OP! 3v3 GND GND TxD RxD RxD TxD Uitgaande van een USB-to-Serial adapter is dit eenvoudig te realiseren door met vier draadjes verbinding tussen de USB-to-Serial Adapter en de DSMR-logger v4 te maken volgens onderstaand schema: Omdat je hiermee de USB2Serial Adapter als een vrij \"domme\" programmer gebruikt moet je in de ArduinoIDE aangeven dat je bij het uploaden van firmware of de data -map geen speciaal protocol gebruikt. In het Tools -menu geef je bij Reset Method None op. Om nu de firmware of de data -map naar de DSMR-logger v4 te flashen moet je de DSMR-logger v4 eerst in Flash-mode zetten. Let op! Koppel, v\u00f3\u00f3rdat je de programmer op de DSMR-logger v4 aansluit, \u00e9\u00e9rst de Slimme Meter los! Dit doe je door achtereenvolgend de volgende handelingen te verrichten: Druk op de FLASH knop en houdt deze ingedrukt Druk vervolgens op de RESET knop Laat de RESET knop los Laat als laatste de FLASH knop los De DSMR-logger staat nu in Flash-mode en blijft in die mode tot er firmware of de inhoud van de data -map wordt ge-upload (of tot je nog een keer op de RESET knop drukt). Hierna start de DSMR-logger normaal op. [ScreenShot ChartActueel]","title":"Programmer DSMRlogger v4"},{"location":"hardware_DSMR_Programmer/#programmer-voor-de-dsmr-logger","text":"Er zijn verschillende manieren om de DSMR-logger van (nieuwe) firmware te voorzien. Dit gaat het eenvoudigst Over The Air (OTA) maar de eerste keer zal dit altijd bedraad moeten. Je kunt hiervoor een FDTI-adapter gebruiken als je er maar voor zorgt dat Vcc 3v3 is! Je moet de volgende verbindingen maken: Programmer DSMR-logger Opmerking Vcc Vcc LET OP! 3v3 GND GND TxD RxD RxD TxD Uitgaande van een USB-to-Serial adapter is dit eenvoudig te realiseren door met vier draadjes verbinding tussen de USB-to-Serial Adapter en de DSMR-logger v4 te maken volgens onderstaand schema: Omdat je hiermee de USB2Serial Adapter als een vrij \"domme\" programmer gebruikt moet je in de ArduinoIDE aangeven dat je bij het uploaden van firmware of de data -map geen speciaal protocol gebruikt. In het Tools -menu geef je bij Reset Method None op. Om nu de firmware of de data -map naar de DSMR-logger v4 te flashen moet je de DSMR-logger v4 eerst in Flash-mode zetten. Let op! Koppel, v\u00f3\u00f3rdat je de programmer op de DSMR-logger v4 aansluit, \u00e9\u00e9rst de Slimme Meter los! Dit doe je door achtereenvolgend de volgende handelingen te verrichten: Druk op de FLASH knop en houdt deze ingedrukt Druk vervolgens op de RESET knop Laat de RESET knop los Laat als laatste de FLASH knop los De DSMR-logger staat nu in Flash-mode en blijft in die mode tot er firmware of de inhoud van de data -map wordt ge-upload (of tot je nog een keer op de RESET knop drukt). Hierna start de DSMR-logger normaal op. [ScreenShot ChartActueel]","title":"Programmer voor de DSMR-logger"},{"location":"hardware_ESP01_Programmer/","text":"Programmer voor de ESP-01 Je kunt hier (www.aandewiel.nl) een post vinden met instructies hoe je eenvoudige een programmer voor de ESP-01 kunt maken. [ScreenShot TabelMaand]","title":"Programmer ESP-01"},{"location":"hardware_ESP01_Programmer/#programmer-voor-de-esp-01","text":"Je kunt hier (www.aandewiel.nl) een post vinden met instructies hoe je eenvoudige een programmer voor de ESP-01 kunt maken. [ScreenShot TabelMaand]","title":"Programmer voor de ESP-01"},{"location":"hardware_V3/","text":"DSMR-logger Versie 3 Hoe je een DSMRlogger Versie 2 kunt bouwen staat hier uitvoerig beschreven. Versie 3 is gelijk aan Versie 2 met dit verschil dat de transistor en voltage regulator eenvoudiger zijn te solderen omdat de pad's verder uit elkaar staan. Versie 3 heeft ook een RJ12 connector waardoor de draadbreuken die met Versie 2 nog wel eens voorkwamen verleden tijd zijn. Een kitje voor Versie 3 kun je hier bestellen. [DSMRlogger Versie 3]","title":"DSMRlogger v3"},{"location":"hardware_V3/#dsmr-logger-versie-3","text":"Hoe je een DSMRlogger Versie 2 kunt bouwen staat hier uitvoerig beschreven. Versie 3 is gelijk aan Versie 2 met dit verschil dat de transistor en voltage regulator eenvoudiger zijn te solderen omdat de pad's verder uit elkaar staan. Versie 3 heeft ook een RJ12 connector waardoor de draadbreuken die met Versie 2 nog wel eens voorkwamen verleden tijd zijn. Een kitje voor Versie 3 kun je hier bestellen.","title":"DSMR-logger Versie 3"},{"location":"hardware_V4/","text":"DSMR-logger Versie 4 Bouwen Het bouwen van de DSMR-logger Versie 4 is vrij Recht Toe, Recht Aan . Bill Of Material Je hebt de volgende componenten nodig: Reference Value Footprint C1 1uF Elco Radial D5.0mm P2.00mm (max. 7mm height) C2 2.2uF Elco Radial D5.0mm P2.00mm C3 470-1000uF Elco Radial D8.0mm P5.00mm C4 100nF Cap. Disc D5.0mm W2.5mm P5.00mm C5 100nF Cap. Disc D5.0mm W2.5mm P5.00mm R5 10R DIN0207 L6.3mm D2.5mm P7.62mm R1 220R DIN0207 L6.3mm D2.5mm P7.62mm R4 220R DIN0207 L6.3mm D2.5mm P7.62mm R7 1k DIN0207 L6.3mm D2.5mm P7.62mm R14 4k7 DIN0207 L6.3mm D2.5mm P7.62mm R15 4k7 DIN0207 L6.3mm D2.5mm P7.62mm R6 4k7 DIN0207 L6.3mm D2.5mm P7.62mm R10 10k DIN0207 L6.3mm D2.5mm P7.62mm R11 10k DIN0207 L6.3mm D2.5mm P7.62mm R2 10k DIN0207 L6.3mm D2.5mm P7.62mm R3 10k DIN0207 L6.3mm D2.5mm P7.62mm R8 10k DIN0207 L6.3mm D2.5mm P7.62mm R9 10k DIN0207 L6.3mm D2.5mm P7.62mm D1 PWR LED LED D3.0mm THT TO-92 Inline U1 LM2937xMP SMD SOT-223-3 TabPin2 U2 4N35 DIP-6 W7.62mm U3 ESP-12 ESP-12E/F Q1 BC547 TO-92 Inline J1 RJ12 female Amphenol 54601 J4 I2C conn PinSocket 1x04 P2.54mm Vertical J5 Programmer PinHeader 1x05 P2.54mm Vertical SW1 RESET THT SW PUSH 6mm H7.3mm SW2 FLASH THT SW PUSH 6mm H20mm-25mm (long shaft) Optioneel R12 12k DIN0207 L6.3mm D2.5mm P7.62mm (E24 \u2013 5% or better) R13 3k DIN0207 L6.3mm D2.5mm P7.62mm (E24 \u2013 5% or better) J9 ADC 0-5v PinHeader 1x02 P2.54mm Vertical oled display 11171 Spanningsdeler ADC R12 en R13 zijn optioneel en afhankelijk van welke spanning je wilt kunnen meten. R12 R14 Maximale spanning op J9 4k7 4k7 0 - 2 volt 8k2 3k3 0 - 3.3 volt 12k 3k 0 - 5 volt 10k 1k2 0 - 10 volt Bouwen Zoals altijd is het het eenvoudigst om eerst de laagste componenten op de printplaat te solderen en dan de steeds hogere componenten. De laagste componenten zijn de SMD voltage regulator (U1, LM2937-3v3) en de processor (U3, ESP-12). Beide zijn zgn. SMD componenten die eigenlijk niet bedoeld zijn om met de hand te solderen, maar het is toch vrij eenvoudig en goed te doen. Begin met het aanbrengen van een druppeltje soldeer op \u00e9\u00e9n van de pads van de LM2937-3v3 (U1): Plaats nu U1 op zijn plek en verwarm de pad plus U1 met de soldeer druppel nogmaals met de soldeerbout .. Als het soldeer is uitgehard zit U1 op zijn plaats en kun je deze aan de overige pads solderen. Voor U3 (ESP-12) geldt hetzelfde princiepe .. .. alleen zijn er v\u00e9\u00e9l meer pads te solderen. Hieronder staat een video waarin je het hele bouw-proces kunt volgen: [DSMR-logger Versie 4]","title":"DSMRlogger v4"},{"location":"hardware_V4/#dsmr-logger-versie-4-bouwen","text":"Het bouwen van de DSMR-logger Versie 4 is vrij Recht Toe, Recht Aan .","title":"DSMR-logger Versie 4 Bouwen"},{"location":"hardware_V4/#bill-of-material","text":"Je hebt de volgende componenten nodig: Reference Value Footprint C1 1uF Elco Radial D5.0mm P2.00mm (max. 7mm height) C2 2.2uF Elco Radial D5.0mm P2.00mm C3 470-1000uF Elco Radial D8.0mm P5.00mm C4 100nF Cap. Disc D5.0mm W2.5mm P5.00mm C5 100nF Cap. Disc D5.0mm W2.5mm P5.00mm R5 10R DIN0207 L6.3mm D2.5mm P7.62mm R1 220R DIN0207 L6.3mm D2.5mm P7.62mm R4 220R DIN0207 L6.3mm D2.5mm P7.62mm R7 1k DIN0207 L6.3mm D2.5mm P7.62mm R14 4k7 DIN0207 L6.3mm D2.5mm P7.62mm R15 4k7 DIN0207 L6.3mm D2.5mm P7.62mm R6 4k7 DIN0207 L6.3mm D2.5mm P7.62mm R10 10k DIN0207 L6.3mm D2.5mm P7.62mm R11 10k DIN0207 L6.3mm D2.5mm P7.62mm R2 10k DIN0207 L6.3mm D2.5mm P7.62mm R3 10k DIN0207 L6.3mm D2.5mm P7.62mm R8 10k DIN0207 L6.3mm D2.5mm P7.62mm R9 10k DIN0207 L6.3mm D2.5mm P7.62mm D1 PWR LED LED D3.0mm THT TO-92 Inline U1 LM2937xMP SMD SOT-223-3 TabPin2 U2 4N35 DIP-6 W7.62mm U3 ESP-12 ESP-12E/F Q1 BC547 TO-92 Inline J1 RJ12 female Amphenol 54601 J4 I2C conn PinSocket 1x04 P2.54mm Vertical J5 Programmer PinHeader 1x05 P2.54mm Vertical SW1 RESET THT SW PUSH 6mm H7.3mm SW2 FLASH THT SW PUSH 6mm H20mm-25mm (long shaft) Optioneel R12 12k DIN0207 L6.3mm D2.5mm P7.62mm (E24 \u2013 5% or better) R13 3k DIN0207 L6.3mm D2.5mm P7.62mm (E24 \u2013 5% or better) J9 ADC 0-5v PinHeader 1x02 P2.54mm Vertical oled display 11171","title":"Bill Of Material"},{"location":"hardware_V4/#spanningsdeler-adc","text":"R12 en R13 zijn optioneel en afhankelijk van welke spanning je wilt kunnen meten. R12 R14 Maximale spanning op J9 4k7 4k7 0 - 2 volt 8k2 3k3 0 - 3.3 volt 12k 3k 0 - 5 volt 10k 1k2 0 - 10 volt","title":"Spanningsdeler ADC"},{"location":"hardware_V4/#bouwen","text":"Zoals altijd is het het eenvoudigst om eerst de laagste componenten op de printplaat te solderen en dan de steeds hogere componenten. De laagste componenten zijn de SMD voltage regulator (U1, LM2937-3v3) en de processor (U3, ESP-12). Beide zijn zgn. SMD componenten die eigenlijk niet bedoeld zijn om met de hand te solderen, maar het is toch vrij eenvoudig en goed te doen. Begin met het aanbrengen van een druppeltje soldeer op \u00e9\u00e9n van de pads van de LM2937-3v3 (U1): Plaats nu U1 op zijn plek en verwarm de pad plus U1 met de soldeer druppel nogmaals met de soldeerbout .. Als het soldeer is uitgehard zit U1 op zijn plaats en kun je deze aan de overige pads solderen. Voor U3 (ESP-12) geldt hetzelfde princiepe .. .. alleen zijn er v\u00e9\u00e9l meer pads te solderen. Hieronder staat een video waarin je het hele bouw-proces kunt volgen: [DSMR-logger Versie 4]","title":"Bouwen"},{"location":"installatieArduinoIDE/","text":"Installatie ArduinoIDE Download en installeer de Arduino Integrated Development Environment (IDE) voor het Operating Systeem (OS) waar jouw DeskTop of LapTop computer (er zijn versies voor Windows, Linux en Mac) mee werkt. Let op! De DSMRloggerWS firmware is getest met de ArduinoIDE v1.8.8 en v1.8.9 Na het downloaden moet je het ontvangen bestand uitpakken (unzip of untar) en installeren. Dat installeren is per OS anders maar staat duidelijk op de website van Arduino aangegeven. Eenmaal ge\u00efnstalleerd kun je direct met de Arduino IDE aan de slag. Om de IDE met de ESP8266 microprocessor te kunnen gebruiken moeten we nog wat stappen uitvoeren. [ScreenShot DSMR-Chart Financieel]","title":"ArduinoIDE"},{"location":"installatieArduinoIDE/#installatie-arduinoide","text":"Download en installeer de Arduino Integrated Development Environment (IDE) voor het Operating Systeem (OS) waar jouw DeskTop of LapTop computer (er zijn versies voor Windows, Linux en Mac) mee werkt. Let op! De DSMRloggerWS firmware is getest met de ArduinoIDE v1.8.8 en v1.8.9 Na het downloaden moet je het ontvangen bestand uitpakken (unzip of untar) en installeren. Dat installeren is per OS anders maar staat duidelijk op de website van Arduino aangegeven. Eenmaal ge\u00efnstalleerd kun je direct met de Arduino IDE aan de slag. Om de IDE met de ESP8266 microprocessor te kunnen gebruiken moeten we nog wat stappen uitvoeren. [ScreenShot DSMR-Chart Financieel]","title":"Installatie ArduinoIDE"},{"location":"installatieBibliotheken/","text":"Installatie Bibliotheken Hier vind je de offici\u00eble instructies voor het installeren van bibliotheken met de ArduinoIDE. Nu je een ArduinoIDE hebt waarmee je ESP8266\u2019s kunt programmeren (flashen) zul je ontdekken dat er door briljante mensen software is ontwikkeld die je kunt gebruiken om complexe projecten te realiseren, zonder dat je zelf het wiel hoeft uit te vinden. Deze software wordt veelal in de vorm van een bibliotheek aangeboden en je hoeft zo\u2019n bibliotheek alleen maar te installeren om er gebruik van te kunnen maken. Bijvoorbeeld een bibliotheek om je ESP8266 van een telnet server te voorzien (met een telnet server kun je via een telnet-client op je DeskTop of LapTop inloggen op je ESP8266). Er blijken hier een aantal bibliotheken voor te bestaan. Als voorbeeld nemen we TelnetStream van Jan Drassy . Na wat Googelen vinden we de software op deze (https://github.com/jandrassy/TelnetStream/) github pagina. Om de bibliotheek te installeren klik je op de groene download knop en selecteer je [Download ZIP]. Onthou waar je het zip-file bewaard! Ga nu naar de ArduinoIDE en selecteer: [ Sketch ] = [ Include Library ] = [ Add .ZIP Library ] Er verschijnt een selectie window waar je het zojuist ge-download-de bestand selecteert. Klik op [Choose]. De bibliotheek is nu ge\u00efnstalleerd en klaar om gebruikt te worden. De meeste bibliotheken komen met een aantal voorbeeld programma\u2019s waarmee je kunt leren hoe je de bibliotheek kunt gebruiken. Jan Drassy is erg summier met zijn uitleg maar gelukkig is er een map met voorbeelden (nou ja, \u00e9\u00e9n voorbeeld). (sorry, het plaatje is een beetje verknipt) Klik je nu op [ TelnetStreamTest ] dan wordt dit voorbeeld programma in de ArduinoIDE geladen. Installeer op dezelfde manier de bibliotheken die in het vorige hoofdstuk zijn genoemd. [ScreenShot DSMR-Dag]","title":"Installeren Bibliotheken"},{"location":"installatieBibliotheken/#installatie-bibliotheken","text":"Hier vind je de offici\u00eble instructies voor het installeren van bibliotheken met de ArduinoIDE. Nu je een ArduinoIDE hebt waarmee je ESP8266\u2019s kunt programmeren (flashen) zul je ontdekken dat er door briljante mensen software is ontwikkeld die je kunt gebruiken om complexe projecten te realiseren, zonder dat je zelf het wiel hoeft uit te vinden. Deze software wordt veelal in de vorm van een bibliotheek aangeboden en je hoeft zo\u2019n bibliotheek alleen maar te installeren om er gebruik van te kunnen maken. Bijvoorbeeld een bibliotheek om je ESP8266 van een telnet server te voorzien (met een telnet server kun je via een telnet-client op je DeskTop of LapTop inloggen op je ESP8266). Er blijken hier een aantal bibliotheken voor te bestaan. Als voorbeeld nemen we TelnetStream van Jan Drassy . Na wat Googelen vinden we de software op deze (https://github.com/jandrassy/TelnetStream/) github pagina. Om de bibliotheek te installeren klik je op de groene download knop en selecteer je [Download ZIP]. Onthou waar je het zip-file bewaard! Ga nu naar de ArduinoIDE en selecteer: [ Sketch ] = [ Include Library ] = [ Add .ZIP Library ] Er verschijnt een selectie window waar je het zojuist ge-download-de bestand selecteert. Klik op [Choose]. De bibliotheek is nu ge\u00efnstalleerd en klaar om gebruikt te worden. De meeste bibliotheken komen met een aantal voorbeeld programma\u2019s waarmee je kunt leren hoe je de bibliotheek kunt gebruiken. Jan Drassy is erg summier met zijn uitleg maar gelukkig is er een map met voorbeelden (nou ja, \u00e9\u00e9n voorbeeld). (sorry, het plaatje is een beetje verknipt) Klik je nu op [ TelnetStreamTest ] dan wordt dit voorbeeld programma in de ArduinoIDE geladen. Installeer op dezelfde manier de bibliotheken die in het vorige hoofdstuk zijn genoemd. [ScreenShot DSMR-Dag]","title":"Installatie Bibliotheken"},{"location":"installatieDataUploadTool/","text":"Installatie Data Upload Tool E\u00e9n van de mooie eigenschappen van de ESP8266 is dat er flash geheugen in zit. Flash geheugen is geheugen dat zijn inhoud ook zonder spanning behoud. Vergelijk het met een SD-kaart. Het flash geheugen is, afhankelijk van het bordje, 512kB tot 16MB(!) groot. Een deel van dit flash geheugen wordt gebruikt om jouw programma in op te slaan. Wat er over blijft kan als bestand-systeem worden ingericht (het zgn. SPI Flash File Systeem \u2011SPIFFS\u2011). Je kunt in je programma dit bestand-systeem niet alleen gebruiken om (bijvoorbeeld meet-) gegevens maar ook om de inhoud van een web-pagina ( index.html ) of een configuratie-bestand in op te slaan. Een index.html maakt dan natuurlijk onderdeel uit van je programma maar deze ontwikkel je niet met de ArduinoIDE. Om het SPI Flash File Systeem voor dit soort bestanden te kunnen gebruiken moet je een plug-in in je Arduino Projecten map installeren. De plug-in haal je hier vandaan. Ga naar deze github pagina en klik op de groen knop.. Selecteer vervolgens [Download ZIP]. Ga nu naar je Sketchbook Location map en maak daarin een nieuwe map tools aan (als deze nog niet bestaat). Pak het zojuist ge-download-de zip bestand uit in deze tools map. Er wordt nu een aantal nieuwe mappen aangemaakt waar de plug-in wordt neergezet. Het pad ziet er ongeveer zo uit: sketchbook location /tools/ESP8266FS/tool/esp8266fs.jar Start de Arduino IDE opnieuw op. Op de menu-balk zie je nu onder [ Tools ] een nieuwe optie: ESP8266 Sketch Data Upload . Als er onder de map van je Sketch \u00f3\u00f3k een map data staat, dan kun je de bestanden die in deze data -map staan met het Sketch Data Upload tool naar het SPIFFS van de ESP8266 flashen. De bestands-tree van de DSMRlogger firmware ziet er zo uit: Het ESP8266 Sketch Data Upload tool zal alle bestanden dit in de data -map zitten naar het SPIFFS van de aangesloten ESP8266 uploaden. Ga naar: [ tools ] - [ ESP8266 Sketch Data Upload ] Randvoorwaarde is natuurlijk dat het SPIFFS groot genoeg is! In de selectie van je board moet je, behalve het juiste type board ook aangeven hoeveel ruimte van je Flash geheugen je wilt gebruiken voor het bestand-systeem (v\u00f3\u00f3rdat je je programma naar de ESP8266 upload!). Normaliter zou je dit zo groot mogelijk willen maken, maar als je \u201cOver The Air\u201d programma\u2019s op je ESP8266 wilt zetten (dus zonder fysieke verbinding maar via WiFi) dan moet je er rekening mee houden dat je twee maal de grootte van je programma nodig hebt om dit te kunnen doen. Wat er overblijft kun je als bestand-systeem gebruiken. [ScreenShot ChartFinancieel]","title":"Data Upload Tool"},{"location":"installatieDataUploadTool/#installatie-data-upload-tool","text":"E\u00e9n van de mooie eigenschappen van de ESP8266 is dat er flash geheugen in zit. Flash geheugen is geheugen dat zijn inhoud ook zonder spanning behoud. Vergelijk het met een SD-kaart. Het flash geheugen is, afhankelijk van het bordje, 512kB tot 16MB(!) groot. Een deel van dit flash geheugen wordt gebruikt om jouw programma in op te slaan. Wat er over blijft kan als bestand-systeem worden ingericht (het zgn. SPI Flash File Systeem \u2011SPIFFS\u2011). Je kunt in je programma dit bestand-systeem niet alleen gebruiken om (bijvoorbeeld meet-) gegevens maar ook om de inhoud van een web-pagina ( index.html ) of een configuratie-bestand in op te slaan. Een index.html maakt dan natuurlijk onderdeel uit van je programma maar deze ontwikkel je niet met de ArduinoIDE. Om het SPI Flash File Systeem voor dit soort bestanden te kunnen gebruiken moet je een plug-in in je Arduino Projecten map installeren. De plug-in haal je hier vandaan. Ga naar deze github pagina en klik op de groen knop.. Selecteer vervolgens [Download ZIP]. Ga nu naar je Sketchbook Location map en maak daarin een nieuwe map tools aan (als deze nog niet bestaat). Pak het zojuist ge-download-de zip bestand uit in deze tools map. Er wordt nu een aantal nieuwe mappen aangemaakt waar de plug-in wordt neergezet. Het pad ziet er ongeveer zo uit: sketchbook location /tools/ESP8266FS/tool/esp8266fs.jar Start de Arduino IDE opnieuw op. Op de menu-balk zie je nu onder [ Tools ] een nieuwe optie: ESP8266 Sketch Data Upload . Als er onder de map van je Sketch \u00f3\u00f3k een map data staat, dan kun je de bestanden die in deze data -map staan met het Sketch Data Upload tool naar het SPIFFS van de ESP8266 flashen. De bestands-tree van de DSMRlogger firmware ziet er zo uit: Het ESP8266 Sketch Data Upload tool zal alle bestanden dit in de data -map zitten naar het SPIFFS van de aangesloten ESP8266 uploaden. Ga naar: [ tools ] - [ ESP8266 Sketch Data Upload ] Randvoorwaarde is natuurlijk dat het SPIFFS groot genoeg is! In de selectie van je board moet je, behalve het juiste type board ook aangeven hoeveel ruimte van je Flash geheugen je wilt gebruiken voor het bestand-systeem (v\u00f3\u00f3rdat je je programma naar de ESP8266 upload!). Normaliter zou je dit zo groot mogelijk willen maken, maar als je \u201cOver The Air\u201d programma\u2019s op je ESP8266 wilt zetten (dus zonder fysieke verbinding maar via WiFi) dan moet je er rekening mee houden dat je twee maal de grootte van je programma nodig hebt om dit te kunnen doen. Wat er overblijft kun je als bestand-systeem gebruiken. [ScreenShot ChartFinancieel]","title":"Installatie Data Upload Tool"},{"location":"installatieESP8266core/","text":"Installatie ESP8266 core In de Arduino IDE moet bij \u201cInstellingen\u201d de volgende URL worden ingevoerd achter \u201c Additional Boards Manager URL\u2019s: \u201d (zie rood omlijnde kader) http://arduino.esp8266.com/stable/package_esp8266com_index.json Lees vooral de uitleg in het README.md bestand en de uitgebreide documentatie op hun website! Er kunnen meer additional board manager URL\u2019s worden ingevuld. Je moet ze dan achter elkaar zetten en scheiden door een komma ( , ). Eventueel kun je ook het pad waar je projecten staan (de Sketchbook Location ) aanpassen. Standaard verwijst deze naar je Documenten map: C:\\Users\\ LogInNaam \\Documents\\arduino\\ .. en dat is een prima plek! De andere instellingen kun je naar behoefte aanpassen. Hierboven staan de instellingen die ik prettig vind. Na het maken van aanpassingen klik je op [OK]. Ga nu via de ArduinoIDE menu-balk naar [ Tools ] - [ Board ] - [ Boards Manager ]. Voer bij filter \u201cesp8266\u201d in. Selecteer de versie die je wilt gaan gebruiken en klik op [ Install ]. Let op! De DSMRloggerWS firmware is getest met versie 2.5.0 . [ScreenShot DSMR-Uur]","title":"ESP8266 Core"},{"location":"installatieESP8266core/#installatie-esp8266-core","text":"In de Arduino IDE moet bij \u201cInstellingen\u201d de volgende URL worden ingevoerd achter \u201c Additional Boards Manager URL\u2019s: \u201d (zie rood omlijnde kader) http://arduino.esp8266.com/stable/package_esp8266com_index.json Lees vooral de uitleg in het README.md bestand en de uitgebreide documentatie op hun website! Er kunnen meer additional board manager URL\u2019s worden ingevuld. Je moet ze dan achter elkaar zetten en scheiden door een komma ( , ). Eventueel kun je ook het pad waar je projecten staan (de Sketchbook Location ) aanpassen. Standaard verwijst deze naar je Documenten map: C:\\Users\\ LogInNaam \\Documents\\arduino\\ .. en dat is een prima plek! De andere instellingen kun je naar behoefte aanpassen. Hierboven staan de instellingen die ik prettig vind. Na het maken van aanpassingen klik je op [OK]. Ga nu via de ArduinoIDE menu-balk naar [ Tools ] - [ Board ] - [ Boards Manager ]. Voer bij filter \u201cesp8266\u201d in. Selecteer de versie die je wilt gaan gebruiken en klik op [ Install ]. Let op! De DSMRloggerWS firmware is getest met versie 2.5.0 . [ScreenShot DSMR-Uur]","title":"Installatie ESP8266 core"},{"location":"introductie/","text":"Introductie Je vindt hier de documentatie voor het project DSMR-logger (Versie 4). De DSMR-logger is een hardware en software systeem waarmee de Slimme Meter (vanaf DSMR versie 4.0) kan worden uitgelezen. De uitgelezen data (telegrammen) worden in de DSMR-logger opgeslagen en kunnen in de vorm van tabellen en charts, via WiFi, op een computer of tablet worden weergegeven. Begrippen In dit document worden de volgende begrippen gebruikt: Begrip Omschrijving DSMR-logger de Hardware DSMR-logger v2 (of Versie 2) Versie 2 van de Hardware Dit is de hardware van de DSMR-logger die is uitgerust met een ESP-01 (Black/S) bordje. Voor deze versie is de firmware DSMRlogger2HTTP bedoeld maar DSMRloggerWS is, met beperkte functionaliteit, ook geschikt te maken voor deze versie van de hardware. DSMR-logger v3 (of Versie 3) Versie 3 van de Hardware Verder gelijk aan Versie 2. DSMR-logger v4 (of Versie 4) Versie 4 van de Hardware Deze hardware is de basis voor dit project DSMRloggerWS De firmware voor de DSMR-logger v4 ESP-01 Een bordje met een ESP8266 processor en 512KB flash geheugen Dit bordje is niet geschikt voor dit project ESP-01 (Black) Een ESP-01 met 1MB flash geheugen Dit bordje heeft een rode Power Led en een blauwe Led op GPIO-01 ESP-01S Een ESP-01 met 1MB flash geheugen Dit bordje heeft alleen een blauwe Led op GPIO-02 ESP-01(Black/S) Een ESP-01 Black of ESP-01S DSMR-logger v2 en v3 maken gebruik van dit bordje ESP-12 Een bordje met een ESP8266 processor en 4MB Flash Geheugen Dit bordje wordt gebruikt in de DSMR-logger v4 Een volledige beschrijving van dit project kun je hier vinden. [DSMRlogger v4]","title":"Introductie"},{"location":"introductie/#introductie","text":"Je vindt hier de documentatie voor het project DSMR-logger (Versie 4). De DSMR-logger is een hardware en software systeem waarmee de Slimme Meter (vanaf DSMR versie 4.0) kan worden uitgelezen. De uitgelezen data (telegrammen) worden in de DSMR-logger opgeslagen en kunnen in de vorm van tabellen en charts, via WiFi, op een computer of tablet worden weergegeven. Begrippen In dit document worden de volgende begrippen gebruikt: Begrip Omschrijving DSMR-logger de Hardware DSMR-logger v2 (of Versie 2) Versie 2 van de Hardware Dit is de hardware van de DSMR-logger die is uitgerust met een ESP-01 (Black/S) bordje. Voor deze versie is de firmware DSMRlogger2HTTP bedoeld maar DSMRloggerWS is, met beperkte functionaliteit, ook geschikt te maken voor deze versie van de hardware. DSMR-logger v3 (of Versie 3) Versie 3 van de Hardware Verder gelijk aan Versie 2. DSMR-logger v4 (of Versie 4) Versie 4 van de Hardware Deze hardware is de basis voor dit project DSMRloggerWS De firmware voor de DSMR-logger v4 ESP-01 Een bordje met een ESP8266 processor en 512KB flash geheugen Dit bordje is niet geschikt voor dit project ESP-01 (Black) Een ESP-01 met 1MB flash geheugen Dit bordje heeft een rode Power Led en een blauwe Led op GPIO-01 ESP-01S Een ESP-01 met 1MB flash geheugen Dit bordje heeft alleen een blauwe Led op GPIO-02 ESP-01(Black/S) Een ESP-01 Black of ESP-01S DSMR-logger v2 en v3 maken gebruik van dit bordje ESP-12 Een bordje met een ESP8266 processor en 4MB Flash Geheugen Dit bordje wordt gebruikt in de DSMR-logger v4 Een volledige beschrijving van dit project kun je hier vinden. [DSMRlogger v4]","title":"Introductie"},{"location":"uploadDataMap_ESP-01/","text":"upload Data map naar ESP-01 De data -map van de DSMRloggerWS firmware kan alleen via een programmer naar de ESP-01 worden overgezet (omdat op de ESP-01 geen OTA mogelijk is). Uitzoeken! Waarschijnlijk kun je de data-map w\u00e9l OTA uploaden omdat de SPIFFS ruimte al gedefinieerd is en deze gewoon overschreven wordt. Je kunt hier een uitvoerige post vinden over hoe je zelf een eenvoudige programmer voor de ESP-01 kunt maken en hoe je die vervolgens moet gebruiken om de firmware en de DSMRloggerWS data -map naar de ESP-01 te uploaden. Uiteraard kun je hiervoor ook iedere andere geschikte programmer gebruiken! Als je de ESP-01 op de programmer hebt aangesloten en deze staat in \"Flash-Mode\" ga dan in de Arduino IDE naar Tools - ESP8266 Sketch Data Upload Let op! De lay-out van de .csv bestanden van de DSMRloggerWS firmware is niet compatibel met die van de DSMRlogger2HTTP firmware. Mocht je de, met de DSMRlogger2HTTP firmware opgebouwde, history willen bewaren, dan moet je deze bestanden \u00e9\u00e9rst naar je computer uploaden (dat kan via de /onderhoud pagina). SPIFFS wordt nu leeg gemaakt en alle bestanden in de data -map worden naar het SPIFFS overgezet. Hierna zal de DSMR-logger normaal opstarten, maar met de nieuw SPIFFS inhoud. Let op! Hou er rekening mee dat eventuele data-bestanden die al op SPIFFS stonden nu weg zijn! Als je ze niet kwijt wil moet je er eerst een kopie van maken op je computer en deze, na het flashen van SPIFFS weer terug zetten (dat kan met behulp van de /onderhoud pagina)! [ScreenShot ChartJaar]","title":"Data Flashen naar ESP-01"},{"location":"uploadDataMap_ESP-01/#upload-data-map-naar-esp-01","text":"De data -map van de DSMRloggerWS firmware kan alleen via een programmer naar de ESP-01 worden overgezet (omdat op de ESP-01 geen OTA mogelijk is). Uitzoeken! Waarschijnlijk kun je de data-map w\u00e9l OTA uploaden omdat de SPIFFS ruimte al gedefinieerd is en deze gewoon overschreven wordt. Je kunt hier een uitvoerige post vinden over hoe je zelf een eenvoudige programmer voor de ESP-01 kunt maken en hoe je die vervolgens moet gebruiken om de firmware en de DSMRloggerWS data -map naar de ESP-01 te uploaden. Uiteraard kun je hiervoor ook iedere andere geschikte programmer gebruiken! Als je de ESP-01 op de programmer hebt aangesloten en deze staat in \"Flash-Mode\" ga dan in de Arduino IDE naar Tools - ESP8266 Sketch Data Upload Let op! De lay-out van de .csv bestanden van de DSMRloggerWS firmware is niet compatibel met die van de DSMRlogger2HTTP firmware. Mocht je de, met de DSMRlogger2HTTP firmware opgebouwde, history willen bewaren, dan moet je deze bestanden \u00e9\u00e9rst naar je computer uploaden (dat kan via de /onderhoud pagina). SPIFFS wordt nu leeg gemaakt en alle bestanden in de data -map worden naar het SPIFFS overgezet. Hierna zal de DSMR-logger normaal opstarten, maar met de nieuw SPIFFS inhoud. Let op! Hou er rekening mee dat eventuele data-bestanden die al op SPIFFS stonden nu weg zijn! Als je ze niet kwijt wil moet je er eerst een kopie van maken op je computer en deze, na het flashen van SPIFFS weer terug zetten (dat kan met behulp van de /onderhoud pagina)! [ScreenShot ChartJaar]","title":"upload Data map naar ESP-01"},{"location":"uploadDataMap_ESP-12/","text":"upload Data map naar DSMR-logger V4 board In de data -map van de DSMRloggerWS firmware staan bestanden die nodig zijn voor het functioneren van de firmware. Deze bestanden moeten dan ook overgezet worden naar de DSMR-logger. Dat 'overzetten' kan op twee manieren: ' Bedraad ' en ' Over The Air ' Bedraad Zorg dat de Serial Monitor is afgesloten. Pas op! Koppel de DSMR-logger los van de Slimme Meter v\u00f3\u00f3rdat je de DSMR-logger op de programmer aansluit!! Sluit de programmer aan op de DSMR-logger v4 . Druk op de FLASH knop en houdt deze ingedrukt. Druk vervolgens de RESET knop in en laat deze weer los. Laat nu ook de FLASH knop los. De DSMR-logger v4 staat nu in \"Flash-mode\" en wacht (geduldig) tot de inhoud van de data map wordt opgestuurd. Ga in de Arduino IDE naar Tools - ESP8266 Sketch Data Upload SPIFFS wordt nu leeg gemaakt en alle bestanden in de data map worden naar het SPIFFS overgezet. Hierna zal de DSMR-logger normaal opstarten, maar met de nieuw SPIFFS inhoud. Let op! Hou er rekening mee dat eventuele data-bestanden die al op SPIFFS stonden nu weg zijn! Als je ze niet kwijt wil moet je er eerst een kopie van maken op je computer en deze, na het flashen van SPIFFS weer terug zetten (dat kan met de DSMR-logger FSexplorer ! Over The Air Bij het Over The Air uploaden van de bestanden uit de data -map kan de DSMRlogger v4 gewoon aan de Slimme Meter gekoppeld blijven. Wel moet de Serial Monitor afgesloten zijn! Alle Board gegevens blijven gelijk alleen selecteer je geen Serial Port maar een Network Port Start vervolgens het ESP8266 Sketch Data Upload -tool Als alle bestanden naar het SPIFFS zijn overgezet zal de DSMR-logger opnieuw opstarten, maar met de nieuwe bestanden. Let op! Hou er rekening mee dat eventuele data-bestanden die al op SPIFFS stonden nu weg zijn! Als je ze niet kwijt wil moet je er eerst een kopie van maken op je computer en deze, na het flashen van SPIFFS weer terug zetten (dat kan met de DSMR-logger FSexplorer ! [ScreenShot PCB V4]","title":"Data Flashen naar DSMRlogger v4"},{"location":"uploadDataMap_ESP-12/#upload-data-map-naar-dsmr-logger-v4-board","text":"In de data -map van de DSMRloggerWS firmware staan bestanden die nodig zijn voor het functioneren van de firmware. Deze bestanden moeten dan ook overgezet worden naar de DSMR-logger. Dat 'overzetten' kan op twee manieren: ' Bedraad ' en ' Over The Air '","title":"upload Data map naar DSMR-logger V4 board"},{"location":"uploadDataMap_ESP-12/#bedraad","text":"Zorg dat de Serial Monitor is afgesloten. Pas op! Koppel de DSMR-logger los van de Slimme Meter v\u00f3\u00f3rdat je de DSMR-logger op de programmer aansluit!! Sluit de programmer aan op de DSMR-logger v4 . Druk op de FLASH knop en houdt deze ingedrukt. Druk vervolgens de RESET knop in en laat deze weer los. Laat nu ook de FLASH knop los. De DSMR-logger v4 staat nu in \"Flash-mode\" en wacht (geduldig) tot de inhoud van de data map wordt opgestuurd. Ga in de Arduino IDE naar Tools - ESP8266 Sketch Data Upload SPIFFS wordt nu leeg gemaakt en alle bestanden in de data map worden naar het SPIFFS overgezet. Hierna zal de DSMR-logger normaal opstarten, maar met de nieuw SPIFFS inhoud. Let op! Hou er rekening mee dat eventuele data-bestanden die al op SPIFFS stonden nu weg zijn! Als je ze niet kwijt wil moet je er eerst een kopie van maken op je computer en deze, na het flashen van SPIFFS weer terug zetten (dat kan met de DSMR-logger FSexplorer !","title":"Bedraad"},{"location":"uploadDataMap_ESP-12/#over-the-air","text":"Bij het Over The Air uploaden van de bestanden uit de data -map kan de DSMRlogger v4 gewoon aan de Slimme Meter gekoppeld blijven. Wel moet de Serial Monitor afgesloten zijn! Alle Board gegevens blijven gelijk alleen selecteer je geen Serial Port maar een Network Port Start vervolgens het ESP8266 Sketch Data Upload -tool Als alle bestanden naar het SPIFFS zijn overgezet zal de DSMR-logger opnieuw opstarten, maar met de nieuwe bestanden. Let op! Hou er rekening mee dat eventuele data-bestanden die al op SPIFFS stonden nu weg zijn! Als je ze niet kwijt wil moet je er eerst een kopie van maken op je computer en deze, na het flashen van SPIFFS weer terug zetten (dat kan met de DSMR-logger FSexplorer ! [ScreenShot PCB V4]","title":"Over The Air"},{"location":"uploadFirmware_ESP-01/","text":"Firmware naar ESP-01 Flashen Let op! De DSMRloggerWS firmware is niet geschikt om, met alle functionaliteit, op een ESP-01 te worden ge-upload. Daarvoor is de omvang van de firmware eenvoudig te groot. Met een ESP-01(Black/S) is het niet mogelijk om Over The Air updates van de firmware of SPIFFS te doen. Ook de RTS hardware en de I2C interface (oled-scherm) zijn voor de ESP-01 niet beschikbaar. Om de firmware naar de ESP-01 (Black/S) te kunnen flashen moet deze eerst voor deze ESP-01 geschikt worden gemaakt. Dit doen we door v\u00f3\u00f3r de #define 's twee slashes ( // ) te zetten. In de ArduinoIDE zien de regels na /*** compiler options ***/ er dan z\u00f3 uit: /******************** compiler options ********************************************/ // #define IS_ESP12 // define if it's an ESP-12 // #define USE_ARDUINO_OTA // define if there is enough memory // #define HAS_OLED_SSD1306 // define if an OLED display is present // #define HAS_NO_METER // define if No Slimme Meter is attached /******************** don't change anything below this line ************************/ Vervolgens moeten de [ Boards ] settings als volgt worden ingevuld: Voor een ESP-01S moeten dezelfde instellingen worden gebruikt, alleen zit bij dit board de \"Builtin Led:\" op GPIO-02 (\"2\")! Stop de ESP-01 in de programmer ( hier vind je een post over hoe je van een USB to ESP-01 Adapter zelf eenvoudig een programmer kunt maken) en sluit deze aan op je computer. Vergeet niet de juiste Port te selecteren en druk op het Compile and Upload icoon . [ScreenShot DSMR-FSexplorer]","title":"Firmware Flashen naar ESP-01"},{"location":"uploadFirmware_ESP-01/#firmware-naar-esp-01-flashen","text":"Let op! De DSMRloggerWS firmware is niet geschikt om, met alle functionaliteit, op een ESP-01 te worden ge-upload. Daarvoor is de omvang van de firmware eenvoudig te groot. Met een ESP-01(Black/S) is het niet mogelijk om Over The Air updates van de firmware of SPIFFS te doen. Ook de RTS hardware en de I2C interface (oled-scherm) zijn voor de ESP-01 niet beschikbaar. Om de firmware naar de ESP-01 (Black/S) te kunnen flashen moet deze eerst voor deze ESP-01 geschikt worden gemaakt. Dit doen we door v\u00f3\u00f3r de #define 's twee slashes ( // ) te zetten. In de ArduinoIDE zien de regels na /*** compiler options ***/ er dan z\u00f3 uit: /******************** compiler options ********************************************/ // #define IS_ESP12 // define if it's an ESP-12 // #define USE_ARDUINO_OTA // define if there is enough memory // #define HAS_OLED_SSD1306 // define if an OLED display is present // #define HAS_NO_METER // define if No Slimme Meter is attached /******************** don't change anything below this line ************************/ Vervolgens moeten de [ Boards ] settings als volgt worden ingevuld: Voor een ESP-01S moeten dezelfde instellingen worden gebruikt, alleen zit bij dit board de \"Builtin Led:\" op GPIO-02 (\"2\")! Stop de ESP-01 in de programmer ( hier vind je een post over hoe je van een USB to ESP-01 Adapter zelf eenvoudig een programmer kunt maken) en sluit deze aan op je computer. Vergeet niet de juiste Port te selecteren en druk op het Compile and Upload icoon . [ScreenShot DSMR-FSexplorer]","title":"Firmware naar ESP-01 Flashen"},{"location":"uploadFirmware_ESP-12/","text":"Firmware Flashen naar DSMR-logger V4 board Versie 4 van de DSMR-logger hardware maakt gebruik van een ESP-12 processor. Deze processor zit op de printplaat van de DSMR-logger gesoldeerd en moet dus, op de printplaat, geflashed worden. Om de firmware naar de DSMRlogger Versie 4 te kunnen flashen moet deze eerst voor de ESP-12 geschikt worden gemaakt. Dit doe je door in de ArduinoIDE de #define 's in het eerste tab-blad aan te passen. Heb je g\u00e9\u00e9n Oled-display (let op de twee slashes voor de derde en vierde #define !): /******************** compiler options ********************************************/ #define IS_ESP12 // define if it's an ESP-12 #define USE_ARDUINO_OTA // define if there is enough memory // #define HAS_OLED_SSD1306 // define if an OLED display is present // #define HAS_NO_METER // define if No Slimme Meter is attached /******************** don't change anything below this line ************************/ Heb je wel een Oled-display op de DSMR-logger aangesloten dan moeten de compiler options als volgt worden aangepast (alleen twee slashes voor de vierde #define !): /******************** compiler options ********************************************/ #define IS_ESP12 // define if it's an ESP-12 #define USE_ARDUINO_OTA // define if there is enough memory #define HAS_OLED_SSD1306 // define if an OLED display is present // #define HAS_NO_METER // define if No Slimme Meter is attached /******************** don't change anything below this line ************************/ Vervolgens moeten de Boards settings als volgt worden ingevuld: Firmware Bedraad Flashen Pas op! Koppel de DSMR-logger los van de Slimme Meter v\u00f3\u00f3rdat je de DSMR-logger op de programmer aansluit!! Sluit de USB- ESP12 programmer aan op de Program -header van de DSMR-logger v4 . Druk de FLASH knop in en houd deze ingedrukt Druk op de RESET knop Laat de RESET knop los Laat de FLASH knop los De DSMR-logger v4 staat nu in Flash-mode en blijft in die mode tot er gegevens vanaf de programmer naar de DSMR-logger zijn overgebracht \u00f3f tot je nog een keer op de RESET knop drukt. Vergeet niet in de ArduinoIDE de Port te selecteren waarop je de USB- ESP12 programmer hebt aangesloten en druk op het Compile and Upload icoon. Firmware Over The Air Flashen Bij het Over The Air flashen van de firmware of data -map kan de DSMR-logger v4 gewoon op de Slimme Meter aangesloten blijven. Alle instellingen voor de DSMRloggerWS firmware blijven gelijk aan de bedraade methode van flashen, alleen moet je geen Serial Port selecteren maar een Network Port . Je herkent de Network Port aan de hostnaam ( DSMR-WS ). Achter de hostnaam zie je het IP-adres van de DSMR-logger (in het plaatje is dat 192.168.12.106). Onthou dat IP-adres!. Normaal gesproken kun je nu op het Compile Upload -Icoon klikken maar vanwege een bug in de tool-chain (zie hier ) moet dat iets ingewikkelder. Klik op het Verify -icoon Als de firmware gecompileerd is moet je de Over The Air upload handmatig starten vanuit een terminal of command window. Dit doe je door het programma espota.py met de volgende parameters aan te roepen: python / Path-To /espota.py -i IP-Address -p 8266 --auth= -f / Path-To /build/DSMRloggerWS.ino.bin Kijk ook hier . [ScreenShot DSMR-PCB]","title":"Firmware Flashen naar DSMRlogger v4"},{"location":"uploadFirmware_ESP-12/#firmware-flashen-naar-dsmr-logger-v4-board","text":"Versie 4 van de DSMR-logger hardware maakt gebruik van een ESP-12 processor. Deze processor zit op de printplaat van de DSMR-logger gesoldeerd en moet dus, op de printplaat, geflashed worden. Om de firmware naar de DSMRlogger Versie 4 te kunnen flashen moet deze eerst voor de ESP-12 geschikt worden gemaakt. Dit doe je door in de ArduinoIDE de #define 's in het eerste tab-blad aan te passen. Heb je g\u00e9\u00e9n Oled-display (let op de twee slashes voor de derde en vierde #define !): /******************** compiler options ********************************************/ #define IS_ESP12 // define if it's an ESP-12 #define USE_ARDUINO_OTA // define if there is enough memory // #define HAS_OLED_SSD1306 // define if an OLED display is present // #define HAS_NO_METER // define if No Slimme Meter is attached /******************** don't change anything below this line ************************/ Heb je wel een Oled-display op de DSMR-logger aangesloten dan moeten de compiler options als volgt worden aangepast (alleen twee slashes voor de vierde #define !): /******************** compiler options ********************************************/ #define IS_ESP12 // define if it's an ESP-12 #define USE_ARDUINO_OTA // define if there is enough memory #define HAS_OLED_SSD1306 // define if an OLED display is present // #define HAS_NO_METER // define if No Slimme Meter is attached /******************** don't change anything below this line ************************/ Vervolgens moeten de Boards settings als volgt worden ingevuld:","title":"Firmware Flashen naar DSMR-logger V4 board"},{"location":"uploadFirmware_ESP-12/#firmware-bedraad-flashen","text":"Pas op! Koppel de DSMR-logger los van de Slimme Meter v\u00f3\u00f3rdat je de DSMR-logger op de programmer aansluit!! Sluit de USB- ESP12 programmer aan op de Program -header van de DSMR-logger v4 . Druk de FLASH knop in en houd deze ingedrukt Druk op de RESET knop Laat de RESET knop los Laat de FLASH knop los De DSMR-logger v4 staat nu in Flash-mode en blijft in die mode tot er gegevens vanaf de programmer naar de DSMR-logger zijn overgebracht \u00f3f tot je nog een keer op de RESET knop drukt. Vergeet niet in de ArduinoIDE de Port te selecteren waarop je de USB- ESP12 programmer hebt aangesloten en druk op het Compile and Upload icoon.","title":"Firmware Bedraad Flashen"},{"location":"uploadFirmware_ESP-12/#firmware-over-the-air-flashen","text":"Bij het Over The Air flashen van de firmware of data -map kan de DSMR-logger v4 gewoon op de Slimme Meter aangesloten blijven. Alle instellingen voor de DSMRloggerWS firmware blijven gelijk aan de bedraade methode van flashen, alleen moet je geen Serial Port selecteren maar een Network Port . Je herkent de Network Port aan de hostnaam ( DSMR-WS ). Achter de hostnaam zie je het IP-adres van de DSMR-logger (in het plaatje is dat 192.168.12.106). Onthou dat IP-adres!. Normaal gesproken kun je nu op het Compile Upload -Icoon klikken maar vanwege een bug in de tool-chain (zie hier ) moet dat iets ingewikkelder. Klik op het Verify -icoon Als de firmware gecompileerd is moet je de Over The Air upload handmatig starten vanuit een terminal of command window. Dit doe je door het programma espota.py met de volgende parameters aan te roepen: python / Path-To /espota.py -i IP-Address -p 8266 --auth= -f / Path-To /build/DSMRloggerWS.ino.bin Kijk ook hier . [ScreenShot DSMR-PCB]","title":"Firmware Over The Air Flashen"},{"location":"uploadOTA-bug/","text":"Upload Over The Air (bug?) Het lijkt erop dat er een bug zit in de toolchain van de ArduinoIDE voor wat betreft het Over The Air uploaden van omvangrijke Firmware. Als je probeert om de DSMRloggerWS firmware via de ArduinoIDE te uploaden krijg je consequent een popUp window te zien waarin gevraagd wordt een password in te voeren: Waarna, wat je ook klikt of invult je de volgende foutmelding in de ArduinoIDE te zien krijgt: .. en het verhaal stopt. Het popUp window is een bekend fenomeen in de Arduino wereld omdat het in verschillende situaties voor kan komen. Helaas wordt er nergens een \u00e9chte oplossing gegeven. Maar gelukkig is er voor d\u00edt probleem een Work Around ! Het blijkt, dat als je de instructie om de firmware te uploaden naar de ESP8266 op de command line handmatig invoert de OTA upload w\u00e9l goed gaat! Inplaats van op het Compile Upload icon te klikken moet je in de IDE op het Verify icon klikken. Onderin de ArduinoIDE in het log venster verschijnt op enig moment de volgende regel: C:\\Users\\(YourLoginName)\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.5.0\\tools\\espota.py \\ -i IPadresVanJeESP8266 -p 8266 --auth= \\ -f C:\\Users\\(YourLoginName)\\AppData\\Local\\Temp\\arduino_build_ nummer \\DSMRloggerWS.ino.bin (voor de duidelijkheid heb ik de regel opgesplits). Als je deze regel eenvoudig kopieerd ( Ctrl-C ) en in een terminal/command window paste ( Ctrl-V ) dan werkt de Over The Air upload w\u00e9l. Let op! Als je alleen sporadisch Firmware die niet (meer) direct via de ArduinoIDE Over The Air ge-upload kan worden wil flashen, dan is bovenstaande voldoende om dit te kunnen doen. De rest van deze pagina kun je dan overslaan. Een OTA upload programma voor de ontwikkelaars Voor gebruikers die zelf de DSMRloggerWS firmware verder willen ontwikkelen - en die dus vaker de Firmware (Over The Air) moeten uploaden - heb ik in de utils directory van de repository twee Python programma's gezet (\u00e9\u00e9n voor Windows en \u00e9\u00e9n voor unix-achtige OS'n) die dit iets eenvoudiger maakt. Om, voor de vervolg stappen, de goede informatie in het log-venster van de ArduinIDE tezien te krijgen moet in de Preferences/Voorkeuren de Show Verbose Output During: upload zijn aangevinkt: Gebruikers die werken met unix of macOS kunnen hier verder lezen. otaUpload programma (Windows) Je roept het programma als volgt aan: python otaUpload.py IP adres van de ESP8266 otaUpload.py 192.168.12.161 otaUpload : [ 1 ] [ DSMRloggerWS.ino.bin ] otaUpload : bin File Found DSMRloggerWS.ino.bin otaUpload : Last Modified Tue Apr 23 14:37:13 2019 ---------------------------------------------------------------------------- otaUpload : espota -i 192.168.12.161 -f DSMRloggerWS.ino.bin Uploading................................................................ ......................................................................... ......................................................................... Done .. Om het programma in jouw omgeving te laten werken moet je een aantal regels aanpassen. 15 #=========================================================== 16 #------ do not change anything above this line! ------------ 17 # 18 #------ location of python --------------------------------- 19 # You can find this by entering the following commands in a 20 # terminal/command window: 21 # 1 python 22 # 2 import sys 23 # 3 sys.executable 24 # 4 'C:\\\\aa\\python.exe' 25 # 5 quit() 26 # 27 # copy/paste the string from line 4 between os.path.join() 28 # 29 PYTHON = os.path.join( C:/Users/(YourLoginName)/AppData/Local/Programs/Python/Python3/python.exe ) 30 ## print( PYTHON [ + PYTHON + ] ) 31 # 32 #------ this is the Sketch Location (see preferences.txt) -- 33 BUILDPATH = os.path.join( C:/Users/(YourLoginName)/Documenten/arduinoBuild ) 34 ## print(' BUILDPATH [' + BUILDPATH + ']') 35 # 36 #------ Edit this ESPOTAPY to point to the location -------- 37 #------ where your espota.py file is on your system -------- 38 ESPOTAPY = os.path.join( C:/Users/(YourLoginName)/AppData/Local/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) 39 ## print(' ESPOTAPY [' + ESPOTAPY + ']') 40 # 41 #------ do not change anything below this line! ------------ 42 #=========================================================== De meeste regels zijn commentaar (\"#\"). Het gaat dan ook alleen om de variabelen die in de regels 29, 33 en 38 een waarde krijgen. Let op! Windows gebruikers zijn gewend om een \" \\ \" ( BackSlash ) in paden te gebruiken. De functie os.path.join() gaat er echter vanuit dat hiervoor de \" / \" ( ForwardSlash ) wordt gebruikt. Op alle pad-aanduidingen die tussen os.path.join() staan moeten enkele of dubbele \" \\\\ \" BackSlashes worden vervangen door \u00e9\u00e9n enkele \" / \" ForwardSlash . PYTHON (Windows) Om erachter te komen waar python op jouw systeem is ge\u00efnstalleerd kun je de volgende instructies in een command window intoetsen: C: C: python Python 2.7.16 (v2.7.16:413a49145e, Mar 4 2019, 01:30:55) Type help , copyright , credits or license for more i import sys sys.executable 'C:\\\\Users\\\\YourLoginName)\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python3\\\\python.exe' quit() De uitvoer onder de regel sys.executable neem je over waarbij je dubbele Backslashes ( \\\\ ) veranderd in \u00e9\u00e9n Slash ( / ). PYTHON = os.path.join('C:/Users/(YourLoginName)/AppData/Local/Programs/Python/Python3/python.exe') BUILDPATH (Windows) BUILDPATH is de variabele die aangeeft waar in jouw setup van de ArduinoIDE de gecompileerde firmware wordt neergezet. Je kunt erachter komen wat het build-pad bij jouw computer is door een simpele Sketch bedraad te uploaden. Je ziet dan zoiets als dit onderin het log-venster verschijnen (voor de duidelijkheid heb ik de regel waar het omgaat in stukjes geknipt): De schets gebruikt 306788 bytes (29%) programma-opslagruimte. Maximum is 1044464 bytes. Globale variabelen gebruiken 28384 bytes (34%) van het dynamisch geheugen. Resteren 53536 bytes voor lokale variabelen. Maximum is 81920 bytes. C:\\Documents and Settings\\(YourLoginName)\\Local Settings\\Application Data\\Arduino15\\packages\\esp8266\\tools\\esptool\\2.5.0-3-20ed2b9/esptool.exe \\ -vv -cd ck -cb 115200 -cp COM3 -ca 0x00000 \\ -cf C:\\Users\\(YourLoginName)\\AppData\\Local\\Temp\\arduino_build_65432/BasicOTA.ino.bin Achter -cf staat het pad waar het om gaat. In dit voorbeeld is dat dit blijkbaar C:\\Users\\(YourLoginName)\\AppData\\Local\\Temp\\arduino_build_65432 waarbij je er rekening mee moet houden dat arduino_build_65432 slechts een tijdelijke map is die, na het opnieuw opstarten van de ArduinoIDE, een ander nummer zal hebben! Om het otaUpload.py programma goed te laten lopen is het noodzakelijk om in de ArduinoIDE preferences.txt het build.path op een vaste lokatie te zetten. Je moet daartoe in de Preferences/Voorkeuren van de ArduinoIDE kijken waar dit bestand op jouw computer te vinden is. Kijk hier wat je dit bestand moet aanpassen. Sluit de ArduinoIDE af (dat is \u00e9cht noodzakelijk!). Open het preferences.txt bestand in je favoriete editor .. .. en voeg deze regel ergens in het begin van het preferences.txt bestand toe: build.path=C:\\Users\\(YourLoginName)\\Documenten\\arduinoBuild Sla het bestand op en start de ArduinoIDE. Neem het pad dat je in preferences.txt hebt opgegeven over in otaUpload.py waarbij je de (\" \\ \") BackSlashes veranderd in (\" / \") ForwardSlashes . #------ this is the Sketch Location (see preferences.txt) -- BUILDPATH = os.path.join( C:/Users/(YourLoginName)/Documenten/arduinoBuild ) # Let op! Ik ben geen Windowz kenner en om mij volkomen onduidelijke redenen heet de map \" documenten \" soms opeens \" documents \" .. of omgekeerd. Hou daar rekening mee bij het opgeven van een vast build.path ! ESPOTAPY (Windows) De variabele ESPOTAPY geeft aan waar op jouw systeem het espota.py programma staat. Als je de Sketch BasicOTA Over The Air upload naar een ESP8266 dan zie je in het log-venster onderin de ArduinoIDE een regel verschijnen die espota.py aanroept. De schets gebruikt 306788 bytes (29%) programma-opslagruimte. Maximum is 1044464 bytes. Globale variabelen gebruiken 28384 bytes (34%) van het dynamisch geheugen. Resteren 53536 bytes voor lokale variabelen. Maximum is 81920 bytes. python.exe C:\\Users\\(YourLoginName)\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.5.0/tools/espota.py \\ -i 192.168.12.161 -p 8266 --auth= \\ -f C:\\Documents and Settings\\(YourLoginName)\\Local Settings\\Temp\\Build/BasicOTA.ino.bin Uploading............................................................................................ ..................................................................................................... ..................... Dit deel van de regel C:\\Users\\(YourLoginName)\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.5.0/tools/espota.py moet je achter ESPOTAPY invullen tussen de haakjes van os.path.join() waarbij je alle enkele (\" \\ \") of dubbele BackSlashes (\" \\\\ \") moet vervangen door \u00e9\u00e9n enkele ForwardSlash (\" / \"). #------ Edit this ESPOTAPY to point to the location -------- #------ where your espota.py file is located -------- ESPOTAPY = os.path.join( C:/Users/(YourLoginName)AppData/Local/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) # Tenslotte moet je het otaUpload.py programma in een map/directory zetten die in de PATH variabele voorkomt of je moet het programma steeds aanroepen met de volledige pad-naam waar het programma staat (bijvoorbeeld pad-naar \\otaUpload.py ). otaUpload programma (Unix OS'n) Je roept het programma als volgt aan: otaUpload IP adres van de ESP8266 $ otaUpload 192.168.12.161 otaUpload : [ 1 ] [ DSMRloggerWS.ino.bin ] otaUpload : bin File Found DSMRloggerWS.ino.bin otaUpload : Last Modified Tue Apr 23 14:37:13 2019 ---------------------------------------------------------------------------- otaUpload : espota -i 192.168.12.161 -f DSMRloggerWS.ino.bin Uploading................................................................ ......................................................................... ......................................................................... Done .. $ Om het programma in jouw omgeving te laten werken moet je een aantal regels aanpassen. 15 #=========================================================== 16 #------ do not change anything above this line! ------------ 17 # 18 #------ where pyton is located ----------------------------- 19 # You can find this by entering the following commands in a 20 # terminal/command window: 21 # 1 python 22 # 2 import sys 23 # 3 sys.executable 24 # 4 '/usr/local/bin/python' 25 # 5 quit() 26 # 27 # copy/paste the string from line 4 between os.path.join() 28 # 29 PYTHON = os.path.join('/usr/local/bin/python') 30 ## print( PYTHON [ + PYTHON + ] ) 31 # 32 #------ this is the Sketch Location (see preferences.txt) -- 33 BUILDPATH = os.path.join( /Users/(YourLoginName)/Documenten/arduinoBuild ) 34 ## print(' BUILDPATH [' + BUILDPATH + ']') 35 # 36 #------ Edit this ESPOTAPY to point to the location -------- 37 #------ where your espota.py file is located -------- 38 ESPOTAPY = os.path.join( /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) 39 ## print(' ESPOTAPY [' + ESPOTAPY + ']') 40 # 41 #------ do not change anything below this line! ------------ 42 #=========================================================== De meeste regels zijn commentaar (\"#\"). Het gaat dan ook alleen om de variabelen die in de regels 29, 33 en 38 een waarde krijgen. PYTHON (Unix-Os) Voor unix achtige OS'n moet hier het volledige pad naar de python binary staan. Je kunt achterhalen waar op jouw computer python is ge\u00efnstalleerd door het volgende in een terminal window in te toetsen: $ which python /usr/local/bin/python $ De reply van het which commando voer je bij de PYTHON variabele in. PYTHON = os.path.join('/usr/local/bin/python') BUILDPATH (Unix-Os) BUILDPATH is de variabele die aangeeft waar in jouw setup van de ArduinoIDE de gecompileerde firmware wordt neergezet. Je kunt erachter komen wat het build-pad bij jouw computer is door een simpele Sketch bedraad te uploaden. Je ziet dan zoiets als dit onderin het log-venster verschijnen (voor de duidelijkheid heb ik de regel waar het omgaat in stukjes geknipt): Sketch uses 307352 bytes (29%) of program storage space. Maximum is 1044464 bytes. Global variables use 28424 bytes (34%) of dynamic memory, leaving 53496 bytes for local variables. Maximum is 81920 bytes. /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/tools/esptool/2.5.0-3-20ed2b9/esptool \\ -vv \\ -cd none -cb 115200 -cp /dev/cu.usbserial-A501B8OQ \\ -ca 0x00000 \\ -cf /var/folders/lt/twpr82k512n1y9dwlck19hp40000gn/T/arduino_build_654814/BasicOTA.ino.bin Achter -cf staat het pad waar het om gaat. Op mijn computer is dit blijkbaar /var/folders/lt/twpr82k512n1y9dwlck19hp40000gn/T/arduino_build_654814/ waarbij zowel het deel achter /lt/ en het nummer 654814 achter arduino_build tijdelijke verwijzingen zijn die steeds een andere waarde zullen hebben. Daarom is het noodzakelijk voor het otaUpload programma om het build-pad een vaste naam te geven die we ook altijd makkelijk kunnen vinden. Om het otaUpload programma goed te laten lopen moet je in de instellingen van de ArduinoIDE een aanpassing aanbrengen. De instellingen staan in preferences.txt en het gaat dan specifiek om de instelling build.path . Je moet daartoe in de Preferences/Voorkeuren van de ArduinoIDE kijken waar dit bestand op jouw computer te vinden is. Sluit de ArduinoIDE af (dat is \u00e9cht noodzakelijk!). Open het preferences.txt bestand in je favoriete editor (zie ook ) .. .. en voeg deze regel ergens in het begin van het preferences.txt bestand toe: build.path=/Users/(YourLoginName)/Documenten/arduinoBuild Sla het bestand op en start de ArduinoIDE. Ik heb het build-pad zo genoemd: /Users/(YourLoginName)/Documenten/arduinoBuild . Neem dit pad over voor de BUILDPATH variabele van het otaUpload programma. #------ this is the Sketch Location (see preferences.txt) -- BUILDPATH = os.path.join( /Users/(YourLoginName)/Documenten/arduinoBuild ) Kijk hier hoe je het preferences.txt kunt aanpassen. ESPOTAPY (Unix-Os) De variabele ESPOTAPY geeft aan waar op jouw systeem het espota.py programma staat. Als je de Sketch BasicOTA Over The Air upload naar een ESP8266 dan zie je in het log-venster onderin de ArduinoIDE een regel verschijnen die espota.py aanroept. Sketch uses 307352 bytes (29%) of program storage space. Maximum is 1044464 bytes. Global variables use 28424 bytes (34%) of dynamic memory, leaving 53496 bytes for local variables. Maximum is 81920 bytes. python /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py \\ -i 192.168.12.161 -p 8266 --auth= \\ -f /var/folders/lt/twpr82k512n1y9dwlck19hp40000gn/T/arduino_build_654814/BasicOTA.ino.bin Uploading................................................................................ ......................................................................................... ............................................. Het deel van de regel achter python vanaf /Users/ tot en met /espota.py moet je achter ESPOTAPY invullen. #------ Edit this ESPOTAPY to point to the location -------- #------ where your espota.py file is located -------- ESPOTAPY = os.path.join( /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) Tenslotte moet je het otaUpload programma in een map/directory zetten die in de PATH variabele voorkomt (bijvoorbeeld /usr/local/bin ) of je moet het programma steeds aanroepen met de volledige pad-naam waar het programma staat (bijvoorbeeld pad-naar \\otaUpload ). preferences.txt Ergens in het preference.txt bestand staan deze instellingen die aangeven hoe je binaries worden ge-build en waar ze worden neergezet. . build.path=/Users/(YourLoginName)/Documenten/arduinoBuild build.verbose=true build.warn_data_percentage=75 . . Het gaat om de variabele build.path . Als deze niet in het preferences.txt bestand staat, raad ik je aan hem toe te voegen met een pad waar je makkelijk bij kunt komen zodat je Sketches altijd op dezelfde plek gecompileerd worden. Het maakt het leven een stukje eenvoudiger ;-) Let op! Pas het preferences.txt bestand alleen aan als de ArduinoIDE is afgesloten! De ArduinoIDE heeft deze preferences in zijn geheugen staan en overschrijft het preferences.txt bestand bij het afsluiten. Dit commentaar vond ik op github m.b.t. de build.path variabele: # temporary build path, normally this goes into the default # temp folder for that platform (as defined by java) # but this can be used to set a specific file in case of problems #build.path=build Als de variabel niet ge-set wordt (er staat een # voor of hij ontbreekt in het preferences.txt bestand) dan wordt de standaard, door java bepaalde, temp directory gebruikt. java.io.tmpdir The default value is typically \"/tmp\", or \"/var/tmp\" on Unix-like platforms. On Microsoft Windows systems the java.io.tmpdir property is typically \"C:\\\\WINNT\\\\TEMP\". .. or .. at Windows 10 it seems to be \"AppData\\Local\\Temp\\\" or \"\\Users\\\\(YourLoginName)\\AppData\\Local\\Temp\\\"","title":"Over The Air (bug?)"},{"location":"uploadOTA-bug/#upload-over-the-air-bug","text":"Het lijkt erop dat er een bug zit in de toolchain van de ArduinoIDE voor wat betreft het Over The Air uploaden van omvangrijke Firmware. Als je probeert om de DSMRloggerWS firmware via de ArduinoIDE te uploaden krijg je consequent een popUp window te zien waarin gevraagd wordt een password in te voeren: Waarna, wat je ook klikt of invult je de volgende foutmelding in de ArduinoIDE te zien krijgt: .. en het verhaal stopt. Het popUp window is een bekend fenomeen in de Arduino wereld omdat het in verschillende situaties voor kan komen. Helaas wordt er nergens een \u00e9chte oplossing gegeven. Maar gelukkig is er voor d\u00edt probleem een Work Around ! Het blijkt, dat als je de instructie om de firmware te uploaden naar de ESP8266 op de command line handmatig invoert de OTA upload w\u00e9l goed gaat! Inplaats van op het Compile Upload icon te klikken moet je in de IDE op het Verify icon klikken. Onderin de ArduinoIDE in het log venster verschijnt op enig moment de volgende regel: C:\\Users\\(YourLoginName)\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.5.0\\tools\\espota.py \\ -i IPadresVanJeESP8266 -p 8266 --auth= \\ -f C:\\Users\\(YourLoginName)\\AppData\\Local\\Temp\\arduino_build_ nummer \\DSMRloggerWS.ino.bin (voor de duidelijkheid heb ik de regel opgesplits). Als je deze regel eenvoudig kopieerd ( Ctrl-C ) en in een terminal/command window paste ( Ctrl-V ) dan werkt de Over The Air upload w\u00e9l. Let op! Als je alleen sporadisch Firmware die niet (meer) direct via de ArduinoIDE Over The Air ge-upload kan worden wil flashen, dan is bovenstaande voldoende om dit te kunnen doen. De rest van deze pagina kun je dan overslaan.","title":"Upload Over The Air (bug?)"},{"location":"uploadOTA-bug/#een-ota-upload-programma-voor-de-ontwikkelaars","text":"Voor gebruikers die zelf de DSMRloggerWS firmware verder willen ontwikkelen - en die dus vaker de Firmware (Over The Air) moeten uploaden - heb ik in de utils directory van de repository twee Python programma's gezet (\u00e9\u00e9n voor Windows en \u00e9\u00e9n voor unix-achtige OS'n) die dit iets eenvoudiger maakt. Om, voor de vervolg stappen, de goede informatie in het log-venster van de ArduinIDE tezien te krijgen moet in de Preferences/Voorkeuren de Show Verbose Output During: upload zijn aangevinkt: Gebruikers die werken met unix of macOS kunnen hier verder lezen.","title":"Een OTA upload programma voor de ontwikkelaars"},{"location":"uploadOTA-bug/#otaupload-programma-windows","text":"Je roept het programma als volgt aan: python otaUpload.py IP adres van de ESP8266 otaUpload.py 192.168.12.161 otaUpload : [ 1 ] [ DSMRloggerWS.ino.bin ] otaUpload : bin File Found DSMRloggerWS.ino.bin otaUpload : Last Modified Tue Apr 23 14:37:13 2019 ---------------------------------------------------------------------------- otaUpload : espota -i 192.168.12.161 -f DSMRloggerWS.ino.bin Uploading................................................................ ......................................................................... ......................................................................... Done .. Om het programma in jouw omgeving te laten werken moet je een aantal regels aanpassen. 15 #=========================================================== 16 #------ do not change anything above this line! ------------ 17 # 18 #------ location of python --------------------------------- 19 # You can find this by entering the following commands in a 20 # terminal/command window: 21 # 1 python 22 # 2 import sys 23 # 3 sys.executable 24 # 4 'C:\\\\aa\\python.exe' 25 # 5 quit() 26 # 27 # copy/paste the string from line 4 between os.path.join() 28 # 29 PYTHON = os.path.join( C:/Users/(YourLoginName)/AppData/Local/Programs/Python/Python3/python.exe ) 30 ## print( PYTHON [ + PYTHON + ] ) 31 # 32 #------ this is the Sketch Location (see preferences.txt) -- 33 BUILDPATH = os.path.join( C:/Users/(YourLoginName)/Documenten/arduinoBuild ) 34 ## print(' BUILDPATH [' + BUILDPATH + ']') 35 # 36 #------ Edit this ESPOTAPY to point to the location -------- 37 #------ where your espota.py file is on your system -------- 38 ESPOTAPY = os.path.join( C:/Users/(YourLoginName)/AppData/Local/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) 39 ## print(' ESPOTAPY [' + ESPOTAPY + ']') 40 # 41 #------ do not change anything below this line! ------------ 42 #=========================================================== De meeste regels zijn commentaar (\"#\"). Het gaat dan ook alleen om de variabelen die in de regels 29, 33 en 38 een waarde krijgen. Let op! Windows gebruikers zijn gewend om een \" \\ \" ( BackSlash ) in paden te gebruiken. De functie os.path.join() gaat er echter vanuit dat hiervoor de \" / \" ( ForwardSlash ) wordt gebruikt. Op alle pad-aanduidingen die tussen os.path.join() staan moeten enkele of dubbele \" \\\\ \" BackSlashes worden vervangen door \u00e9\u00e9n enkele \" / \" ForwardSlash .","title":"otaUpload programma (Windows)"},{"location":"uploadOTA-bug/#python-windows","text":"Om erachter te komen waar python op jouw systeem is ge\u00efnstalleerd kun je de volgende instructies in een command window intoetsen: C: C: python Python 2.7.16 (v2.7.16:413a49145e, Mar 4 2019, 01:30:55) Type help , copyright , credits or license for more i import sys sys.executable 'C:\\\\Users\\\\YourLoginName)\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python3\\\\python.exe' quit() De uitvoer onder de regel sys.executable neem je over waarbij je dubbele Backslashes ( \\\\ ) veranderd in \u00e9\u00e9n Slash ( / ). PYTHON = os.path.join('C:/Users/(YourLoginName)/AppData/Local/Programs/Python/Python3/python.exe')","title":"PYTHON (Windows)"},{"location":"uploadOTA-bug/#buildpath-windows","text":"BUILDPATH is de variabele die aangeeft waar in jouw setup van de ArduinoIDE de gecompileerde firmware wordt neergezet. Je kunt erachter komen wat het build-pad bij jouw computer is door een simpele Sketch bedraad te uploaden. Je ziet dan zoiets als dit onderin het log-venster verschijnen (voor de duidelijkheid heb ik de regel waar het omgaat in stukjes geknipt): De schets gebruikt 306788 bytes (29%) programma-opslagruimte. Maximum is 1044464 bytes. Globale variabelen gebruiken 28384 bytes (34%) van het dynamisch geheugen. Resteren 53536 bytes voor lokale variabelen. Maximum is 81920 bytes. C:\\Documents and Settings\\(YourLoginName)\\Local Settings\\Application Data\\Arduino15\\packages\\esp8266\\tools\\esptool\\2.5.0-3-20ed2b9/esptool.exe \\ -vv -cd ck -cb 115200 -cp COM3 -ca 0x00000 \\ -cf C:\\Users\\(YourLoginName)\\AppData\\Local\\Temp\\arduino_build_65432/BasicOTA.ino.bin Achter -cf staat het pad waar het om gaat. In dit voorbeeld is dat dit blijkbaar C:\\Users\\(YourLoginName)\\AppData\\Local\\Temp\\arduino_build_65432 waarbij je er rekening mee moet houden dat arduino_build_65432 slechts een tijdelijke map is die, na het opnieuw opstarten van de ArduinoIDE, een ander nummer zal hebben! Om het otaUpload.py programma goed te laten lopen is het noodzakelijk om in de ArduinoIDE preferences.txt het build.path op een vaste lokatie te zetten. Je moet daartoe in de Preferences/Voorkeuren van de ArduinoIDE kijken waar dit bestand op jouw computer te vinden is. Kijk hier wat je dit bestand moet aanpassen. Sluit de ArduinoIDE af (dat is \u00e9cht noodzakelijk!). Open het preferences.txt bestand in je favoriete editor .. .. en voeg deze regel ergens in het begin van het preferences.txt bestand toe: build.path=C:\\Users\\(YourLoginName)\\Documenten\\arduinoBuild Sla het bestand op en start de ArduinoIDE. Neem het pad dat je in preferences.txt hebt opgegeven over in otaUpload.py waarbij je de (\" \\ \") BackSlashes veranderd in (\" / \") ForwardSlashes . #------ this is the Sketch Location (see preferences.txt) -- BUILDPATH = os.path.join( C:/Users/(YourLoginName)/Documenten/arduinoBuild ) # Let op! Ik ben geen Windowz kenner en om mij volkomen onduidelijke redenen heet de map \" documenten \" soms opeens \" documents \" .. of omgekeerd. Hou daar rekening mee bij het opgeven van een vast build.path !","title":"BUILDPATH (Windows)"},{"location":"uploadOTA-bug/#espotapy-windows","text":"De variabele ESPOTAPY geeft aan waar op jouw systeem het espota.py programma staat. Als je de Sketch BasicOTA Over The Air upload naar een ESP8266 dan zie je in het log-venster onderin de ArduinoIDE een regel verschijnen die espota.py aanroept. De schets gebruikt 306788 bytes (29%) programma-opslagruimte. Maximum is 1044464 bytes. Globale variabelen gebruiken 28384 bytes (34%) van het dynamisch geheugen. Resteren 53536 bytes voor lokale variabelen. Maximum is 81920 bytes. python.exe C:\\Users\\(YourLoginName)\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.5.0/tools/espota.py \\ -i 192.168.12.161 -p 8266 --auth= \\ -f C:\\Documents and Settings\\(YourLoginName)\\Local Settings\\Temp\\Build/BasicOTA.ino.bin Uploading............................................................................................ ..................................................................................................... ..................... Dit deel van de regel C:\\Users\\(YourLoginName)\\AppData\\Local\\Arduino15\\packages\\esp8266\\hardware\\esp8266\\2.5.0/tools/espota.py moet je achter ESPOTAPY invullen tussen de haakjes van os.path.join() waarbij je alle enkele (\" \\ \") of dubbele BackSlashes (\" \\\\ \") moet vervangen door \u00e9\u00e9n enkele ForwardSlash (\" / \"). #------ Edit this ESPOTAPY to point to the location -------- #------ where your espota.py file is located -------- ESPOTAPY = os.path.join( C:/Users/(YourLoginName)AppData/Local/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) # Tenslotte moet je het otaUpload.py programma in een map/directory zetten die in de PATH variabele voorkomt of je moet het programma steeds aanroepen met de volledige pad-naam waar het programma staat (bijvoorbeeld pad-naar \\otaUpload.py ).","title":"ESPOTAPY (Windows)"},{"location":"uploadOTA-bug/#otaupload-programma-unix-osn","text":"Je roept het programma als volgt aan: otaUpload IP adres van de ESP8266 $ otaUpload 192.168.12.161 otaUpload : [ 1 ] [ DSMRloggerWS.ino.bin ] otaUpload : bin File Found DSMRloggerWS.ino.bin otaUpload : Last Modified Tue Apr 23 14:37:13 2019 ---------------------------------------------------------------------------- otaUpload : espota -i 192.168.12.161 -f DSMRloggerWS.ino.bin Uploading................................................................ ......................................................................... ......................................................................... Done .. $ Om het programma in jouw omgeving te laten werken moet je een aantal regels aanpassen. 15 #=========================================================== 16 #------ do not change anything above this line! ------------ 17 # 18 #------ where pyton is located ----------------------------- 19 # You can find this by entering the following commands in a 20 # terminal/command window: 21 # 1 python 22 # 2 import sys 23 # 3 sys.executable 24 # 4 '/usr/local/bin/python' 25 # 5 quit() 26 # 27 # copy/paste the string from line 4 between os.path.join() 28 # 29 PYTHON = os.path.join('/usr/local/bin/python') 30 ## print( PYTHON [ + PYTHON + ] ) 31 # 32 #------ this is the Sketch Location (see preferences.txt) -- 33 BUILDPATH = os.path.join( /Users/(YourLoginName)/Documenten/arduinoBuild ) 34 ## print(' BUILDPATH [' + BUILDPATH + ']') 35 # 36 #------ Edit this ESPOTAPY to point to the location -------- 37 #------ where your espota.py file is located -------- 38 ESPOTAPY = os.path.join( /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) 39 ## print(' ESPOTAPY [' + ESPOTAPY + ']') 40 # 41 #------ do not change anything below this line! ------------ 42 #=========================================================== De meeste regels zijn commentaar (\"#\"). Het gaat dan ook alleen om de variabelen die in de regels 29, 33 en 38 een waarde krijgen.","title":"otaUpload programma (Unix OS'n)"},{"location":"uploadOTA-bug/#python-unix-os","text":"Voor unix achtige OS'n moet hier het volledige pad naar de python binary staan. Je kunt achterhalen waar op jouw computer python is ge\u00efnstalleerd door het volgende in een terminal window in te toetsen: $ which python /usr/local/bin/python $ De reply van het which commando voer je bij de PYTHON variabele in. PYTHON = os.path.join('/usr/local/bin/python')","title":"PYTHON (Unix-Os)"},{"location":"uploadOTA-bug/#buildpath-unix-os","text":"BUILDPATH is de variabele die aangeeft waar in jouw setup van de ArduinoIDE de gecompileerde firmware wordt neergezet. Je kunt erachter komen wat het build-pad bij jouw computer is door een simpele Sketch bedraad te uploaden. Je ziet dan zoiets als dit onderin het log-venster verschijnen (voor de duidelijkheid heb ik de regel waar het omgaat in stukjes geknipt): Sketch uses 307352 bytes (29%) of program storage space. Maximum is 1044464 bytes. Global variables use 28424 bytes (34%) of dynamic memory, leaving 53496 bytes for local variables. Maximum is 81920 bytes. /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/tools/esptool/2.5.0-3-20ed2b9/esptool \\ -vv \\ -cd none -cb 115200 -cp /dev/cu.usbserial-A501B8OQ \\ -ca 0x00000 \\ -cf /var/folders/lt/twpr82k512n1y9dwlck19hp40000gn/T/arduino_build_654814/BasicOTA.ino.bin Achter -cf staat het pad waar het om gaat. Op mijn computer is dit blijkbaar /var/folders/lt/twpr82k512n1y9dwlck19hp40000gn/T/arduino_build_654814/ waarbij zowel het deel achter /lt/ en het nummer 654814 achter arduino_build tijdelijke verwijzingen zijn die steeds een andere waarde zullen hebben. Daarom is het noodzakelijk voor het otaUpload programma om het build-pad een vaste naam te geven die we ook altijd makkelijk kunnen vinden. Om het otaUpload programma goed te laten lopen moet je in de instellingen van de ArduinoIDE een aanpassing aanbrengen. De instellingen staan in preferences.txt en het gaat dan specifiek om de instelling build.path . Je moet daartoe in de Preferences/Voorkeuren van de ArduinoIDE kijken waar dit bestand op jouw computer te vinden is. Sluit de ArduinoIDE af (dat is \u00e9cht noodzakelijk!). Open het preferences.txt bestand in je favoriete editor (zie ook ) .. .. en voeg deze regel ergens in het begin van het preferences.txt bestand toe: build.path=/Users/(YourLoginName)/Documenten/arduinoBuild Sla het bestand op en start de ArduinoIDE. Ik heb het build-pad zo genoemd: /Users/(YourLoginName)/Documenten/arduinoBuild . Neem dit pad over voor de BUILDPATH variabele van het otaUpload programma. #------ this is the Sketch Location (see preferences.txt) -- BUILDPATH = os.path.join( /Users/(YourLoginName)/Documenten/arduinoBuild ) Kijk hier hoe je het preferences.txt kunt aanpassen.","title":"BUILDPATH (Unix-Os)"},{"location":"uploadOTA-bug/#espotapy-unix-os","text":"De variabele ESPOTAPY geeft aan waar op jouw systeem het espota.py programma staat. Als je de Sketch BasicOTA Over The Air upload naar een ESP8266 dan zie je in het log-venster onderin de ArduinoIDE een regel verschijnen die espota.py aanroept. Sketch uses 307352 bytes (29%) of program storage space. Maximum is 1044464 bytes. Global variables use 28424 bytes (34%) of dynamic memory, leaving 53496 bytes for local variables. Maximum is 81920 bytes. python /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py \\ -i 192.168.12.161 -p 8266 --auth= \\ -f /var/folders/lt/twpr82k512n1y9dwlck19hp40000gn/T/arduino_build_654814/BasicOTA.ino.bin Uploading................................................................................ ......................................................................................... ............................................. Het deel van de regel achter python vanaf /Users/ tot en met /espota.py moet je achter ESPOTAPY invullen. #------ Edit this ESPOTAPY to point to the location -------- #------ where your espota.py file is located -------- ESPOTAPY = os.path.join( /Users/(YourLoginName)/Library/Arduino15/packages/esp8266/hardware/esp8266/2.5.0/tools/espota.py ) Tenslotte moet je het otaUpload programma in een map/directory zetten die in de PATH variabele voorkomt (bijvoorbeeld /usr/local/bin ) of je moet het programma steeds aanroepen met de volledige pad-naam waar het programma staat (bijvoorbeeld pad-naar \\otaUpload ).","title":"ESPOTAPY (Unix-Os)"},{"location":"uploadOTA-bug/#preferencestxt","text":"Ergens in het preference.txt bestand staan deze instellingen die aangeven hoe je binaries worden ge-build en waar ze worden neergezet. . build.path=/Users/(YourLoginName)/Documenten/arduinoBuild build.verbose=true build.warn_data_percentage=75 . . Het gaat om de variabele build.path . Als deze niet in het preferences.txt bestand staat, raad ik je aan hem toe te voegen met een pad waar je makkelijk bij kunt komen zodat je Sketches altijd op dezelfde plek gecompileerd worden. Het maakt het leven een stukje eenvoudiger ;-) Let op! Pas het preferences.txt bestand alleen aan als de ArduinoIDE is afgesloten! De ArduinoIDE heeft deze preferences in zijn geheugen staan en overschrijft het preferences.txt bestand bij het afsluiten. Dit commentaar vond ik op github m.b.t. de build.path variabele: # temporary build path, normally this goes into the default # temp folder for that platform (as defined by java) # but this can be used to set a specific file in case of problems #build.path=build Als de variabel niet ge-set wordt (er staat een # voor of hij ontbreekt in het preferences.txt bestand) dan wordt de standaard, door java bepaalde, temp directory gebruikt. java.io.tmpdir The default value is typically \"/tmp\", or \"/var/tmp\" on Unix-like platforms. On Microsoft Windows systems the java.io.tmpdir property is typically \"C:\\\\WINNT\\\\TEMP\". .. or .. at Windows 10 it seems to be \"AppData\\Local\\Temp\\\" or \"\\Users\\\\(YourLoginName)\\AppData\\Local\\Temp\\\"","title":"preferences.txt"},{"location":"verschillenESP8266/","text":"verschillen ESP8266 ESP-01 ESP-01 (Black Edition) ESP-01S ESP-12 ESP-01 De ESP-01 heeft slechts 512MB flash geheugen en is niet geschikt voor de DSMR-logger ESP-01 (Black Edition) Dit is de versie van de ESP8266 waar versie 3 van de DSMR-logger op is gebaseerd. Deze versie heeft een rode power led en een blauwe led die op GPIO-01 is aangesloten. Deze versie heeft 1MB flash geheugen. ESP-01S Oorspronkelijk had deze ESP-01 ook slecht 512MB flash geheugen. De versie die nu meestal verkocht wordt heeft echter 1MB geheugen. Het is dus wel zaak op te letten wat voor versie je koopt! De ESP-01S heeft geen power led en de blauwe led is niet op GPIO-01 maar op GPIO-02 aangesloten. Deze versie van de ESP-01 is geschikt voor de DSMR-logger ESP-12 Deze ESP8266 heeft 4MB flash geheugen. Een blauwe led is aangesloten op GPIO-02. Daarnaast heeft de ESP-12 12 GPIO pinnen waarvan de meeste vrij te gebruiken zijn. Versie 4 van de DSMR-logger is ontworpen rond de ESP-12. [ScreenShot DSMR-SystemInfo]","title":"Verschillen ESP8266 modules"},{"location":"verschillenESP8266/#verschillen-esp8266","text":"ESP-01 ESP-01 (Black Edition) ESP-01S ESP-12","title":"verschillen ESP8266"},{"location":"verschillenESP8266/#esp-01","text":"De ESP-01 heeft slechts 512MB flash geheugen en is niet geschikt voor de DSMR-logger","title":"ESP-01"},{"location":"verschillenESP8266/#esp-01-black-edition","text":"Dit is de versie van de ESP8266 waar versie 3 van de DSMR-logger op is gebaseerd. Deze versie heeft een rode power led en een blauwe led die op GPIO-01 is aangesloten. Deze versie heeft 1MB flash geheugen.","title":"ESP-01 (Black Edition)"},{"location":"verschillenESP8266/#esp-01s","text":"Oorspronkelijk had deze ESP-01 ook slecht 512MB flash geheugen. De versie die nu meestal verkocht wordt heeft echter 1MB geheugen. Het is dus wel zaak op te letten wat voor versie je koopt! De ESP-01S heeft geen power led en de blauwe led is niet op GPIO-01 maar op GPIO-02 aangesloten. Deze versie van de ESP-01 is geschikt voor de DSMR-logger","title":"ESP-01S"},{"location":"verschillenESP8266/#esp-12","text":"Deze ESP8266 heeft 4MB flash geheugen. Een blauwe led is aangesloten op GPIO-02. Daarnaast heeft de ESP-12 12 GPIO pinnen waarvan de meeste vrij te gebruiken zijn. Versie 4 van de DSMR-logger is ontworpen rond de ESP-12. [ScreenShot DSMR-SystemInfo]","title":"ESP-12"}]}